(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))b(_);new MutationObserver(_=>{for(const F of _)if(F.type==="childList")for(const O of F.addedNodes)O.tagName==="LINK"&&O.rel==="modulepreload"&&b(O)}).observe(document,{childList:!0,subtree:!0});function u(_){const F={};return _.integrity&&(F.integrity=_.integrity),_.referrerPolicy&&(F.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?F.credentials="include":_.crossOrigin==="anonymous"?F.credentials="omit":F.credentials="same-origin",F}function b(_){if(_.ep)return;_.ep=!0;const F=u(_);fetch(_.href,F)}})();var fn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gr={},Ri={get exports(){return gr},set exports(o){gr=o}};/*! For license information please see lsplugin.user.js.LICENSE.txt */(function(o,a){(function(u,b){o.exports=b()})(self,()=>(()=>{var u={227:(O,h,L)=>{var P=L(155);h.formatArgs=function(C){if(C[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+C[0]+(this.useColors?"%c ":" ")+"+"+O.exports.humanize(this.diff),!this.useColors)return;const Z="color: "+this.color;C.splice(1,0,Z,"color: inherit");let x=0,y=0;C[0].replace(/%[a-zA-Z%]/g,A=>{A!=="%%"&&(x++,A==="%c"&&(y=x))}),C.splice(y,0,Z)},h.save=function(C){try{C?h.storage.setItem("debug",C):h.storage.removeItem("debug")}catch{}},h.load=function(){let C;try{C=h.storage.getItem("debug")}catch{}return!C&&P!==void 0&&"env"in P&&(C=P.env.DEBUG),C},h.useColors=function(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},h.storage=function(){try{return localStorage}catch{}}(),h.destroy=(()=>{let C=!1;return()=>{C||(C=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),h.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],h.log=console.debug||console.log||(()=>{}),O.exports=L(447)(h);const{formatters:g}=O.exports;g.j=function(C){try{return JSON.stringify(C)}catch(Z){return"[UnexpectedJSONParseError]: "+Z.message}}},447:(O,h,L)=>{O.exports=function(P){function g(x){let y,A,S,G=null;function q(...V){if(!q.enabled)return;const Q=q,R=Number(new Date),H=R-(y||R);Q.diff=H,Q.prev=y,Q.curr=R,y=R,V[0]=g.coerce(V[0]),typeof V[0]!="string"&&V.unshift("%O");let c=0;V[0]=V[0].replace(/%([a-zA-Z%])/g,(f,w)=>{if(f==="%%")return"%";c++;const T=g.formatters[w];if(typeof T=="function"){const X=V[c];f=T.call(Q,X),V.splice(c,1),c--}return f}),g.formatArgs.call(Q,V),(Q.log||g.log).apply(Q,V)}return q.namespace=x,q.useColors=g.useColors(),q.color=g.selectColor(x),q.extend=C,q.destroy=g.destroy,Object.defineProperty(q,"enabled",{enumerable:!0,configurable:!1,get:()=>G!==null?G:(A!==g.namespaces&&(A=g.namespaces,S=g.enabled(x)),S),set:V=>{G=V}}),typeof g.init=="function"&&g.init(q),q}function C(x,y){const A=g(this.namespace+(y===void 0?":":y)+x);return A.log=this.log,A}function Z(x){return x.toString().substring(2,x.toString().length-2).replace(/\.\*\?$/,"*")}return g.debug=g,g.default=g,g.coerce=function(x){return x instanceof Error?x.stack||x.message:x},g.disable=function(){const x=[...g.names.map(Z),...g.skips.map(Z).map(y=>"-"+y)].join(",");return g.enable(""),x},g.enable=function(x){let y;g.save(x),g.namespaces=x,g.names=[],g.skips=[];const A=(typeof x=="string"?x:"").split(/[\s,]+/),S=A.length;for(y=0;y<S;y++)A[y]&&((x=A[y].replace(/\*/g,".*?"))[0]==="-"?g.skips.push(new RegExp("^"+x.slice(1)+"$")):g.names.push(new RegExp("^"+x+"$")))},g.enabled=function(x){if(x[x.length-1]==="*")return!0;let y,A;for(y=0,A=g.skips.length;y<A;y++)if(g.skips[y].test(x))return!1;for(y=0,A=g.names.length;y<A;y++)if(g.names[y].test(x))return!0;return!1},g.humanize=L(824),g.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(P).forEach(x=>{g[x]=P[x]}),g.names=[],g.skips=[],g.formatters={},g.selectColor=function(x){let y=0;for(let A=0;A<x.length;A++)y=(y<<5)-y+x.charCodeAt(A),y|=0;return g.colors[Math.abs(y)%g.colors.length]},g.enable(g.load()),g}},856:function(O){O.exports=function(){function h(E){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},h(E)}function L(E,M){return L=Object.setPrototypeOf||function(Y,te){return Y.__proto__=te,Y},L(E,M)}function P(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function g(E,M,Y){return g=P()?Reflect.construct:function(te,le,Ne){var Ke=[null];Ke.push.apply(Ke,le);var Re=new(Function.bind.apply(te,Ke));return Ne&&L(Re,Ne.prototype),Re},g.apply(null,arguments)}function C(E){return Z(E)||x(E)||y(E)||S()}function Z(E){if(Array.isArray(E))return A(E)}function x(E){if(typeof Symbol<"u"&&E[Symbol.iterator]!=null||E["@@iterator"]!=null)return Array.from(E)}function y(E,M){if(E){if(typeof E=="string")return A(E,M);var Y=Object.prototype.toString.call(E).slice(8,-1);return Y==="Object"&&E.constructor&&(Y=E.constructor.name),Y==="Map"||Y==="Set"?Array.from(E):Y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Y)?A(E,M):void 0}}function A(E,M){(M==null||M>E.length)&&(M=E.length);for(var Y=0,te=new Array(M);Y<M;Y++)te[Y]=E[Y];return te}function S(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G=Object.hasOwnProperty,q=Object.setPrototypeOf,V=Object.isFrozen,Q=Object.getPrototypeOf,R=Object.getOwnPropertyDescriptor,H=Object.freeze,c=Object.seal,f=Object.create,w=typeof Reflect<"u"&&Reflect,T=w.apply,X=w.construct;T||(T=function(E,M,Y){return E.apply(M,Y)}),H||(H=function(E){return E}),c||(c=function(E){return E}),X||(X=function(E,M){return g(E,C(M))});var re=ie(Array.prototype.forEach),ce=ie(Array.prototype.pop),ve=ie(Array.prototype.push),ke=ie(String.prototype.toLowerCase),Ae=ie(String.prototype.match),he=ie(String.prototype.replace),Fe=ie(String.prototype.indexOf),m=ie(String.prototype.trim),k=ie(RegExp.prototype.test),B=Se(TypeError);function ie(E){return function(M){for(var Y=arguments.length,te=new Array(Y>1?Y-1:0),le=1;le<Y;le++)te[le-1]=arguments[le];return T(E,M,te)}}function Se(E){return function(){for(var M=arguments.length,Y=new Array(M),te=0;te<M;te++)Y[te]=arguments[te];return X(E,Y)}}function $(E,M){q&&q(E,null);for(var Y=M.length;Y--;){var te=M[Y];if(typeof te=="string"){var le=ke(te);le!==te&&(V(M)||(M[Y]=le),te=le)}E[te]=!0}return E}function K(E){var M,Y=f(null);for(M in E)T(G,E,[M])&&(Y[M]=E[M]);return Y}function fe(E,M){for(;E!==null;){var Y=R(E,M);if(Y){if(Y.get)return ie(Y.get);if(typeof Y.value=="function")return ie(Y.value)}E=Q(E)}function te(le){return console.warn("fallback value for",le),null}return te}var Oe=H(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Le=H(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Be=H(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ot=H(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ge=H(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),de=H(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),je=H(["#text"]),Ee=H(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Te=H(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Me=H(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),De=H(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Rt=c(/\{\{[\w\W]*|[\w\W]*\}\}/gm),St=c(/<%[\w\W]*|[\w\W]*%>/gm),Hn=c(/^data-[\-\w.\u00B7-\uFFFF]/),Bn=c(/^aria-[\-\w]+$/),$n=c(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Gn=c(/^(?:\w+script|data):/i),it=c(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),gn=c(/^html$/i),Zn=function(){return typeof window>"u"?null:window},Vn=function(E,M){if(h(E)!=="object"||typeof E.createPolicy!="function")return null;var Y=null,te="data-tt-policy-suffix";M.currentScript&&M.currentScript.hasAttribute(te)&&(Y=M.currentScript.getAttribute(te));var le="dompurify"+(Y?"#"+Y:"");try{return E.createPolicy(le,{createHTML:function(Ne){return Ne}})}catch{return console.warn("TrustedTypes policy "+le+" could not be created."),null}};function ht(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zn(),M=function(i){return ht(i)};if(M.version="2.3.8",M.removed=[],!E||!E.document||E.document.nodeType!==9)return M.isSupported=!1,M;var Y=E.document,te=E.document,le=E.DocumentFragment,Ne=E.HTMLTemplateElement,Ke=E.Node,Re=E.Element,et=E.NodeFilter,gt=E.NamedNodeMap,Lt=gt===void 0?E.NamedNodeMap||E.MozNamedAttrMap:gt,Dt=E.HTMLFormElement,mn=E.DOMParser,yn=E.trustedTypes,mt=Re.prototype,vn=fe(mt,"cloneNode"),bn=fe(mt,"nextSibling"),Wn=fe(mt,"childNodes"),st=fe(mt,"parentNode");if(typeof Ne=="function"){var zt=te.createElement("template");zt.content&&zt.content.ownerDocument&&(te=zt.content.ownerDocument)}var $e=Vn(yn,Y),wn=$e?$e.createHTML(""):"",yt=te,Ut=yt.implementation,_n=yt.createNodeIterator,xn=yt.createDocumentFragment,Yn=yt.getElementsByTagName,qt=Y.importNode,Cn={};try{Cn=K(te).documentMode?te.documentMode:{}}catch{}var _e={};M.isSupported=typeof st=="function"&&Ut&&Ut.createHTMLDocument!==void 0&&Cn!==9;var at,Ge,Ht=Rt,Bt=St,jt=Hn,Pe=Bn,$t=Gn,vt=it,Gt=$n,be=null,Zt=$({},[].concat(C(Oe),C(Le),C(Be),C(ge),C(je))),we=null,Vt=$({},[].concat(C(Ee),C(Te),C(Me),C(De))),ue=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),bt=null,Wt=null,Yt=!0,Jt=!0,kn=!1,ct=!1,oe=!1,Qt=!1,Xt=!1,tt=!1,Ze=!1,lt=!1,Kt=!0,Et=!0,nt=!1,Ve={},ut=null,An=$({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Sn=null,Ln=$({},["audio","video","img","source","image","track"]),en=null,Ot=$({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tn="http://www.w3.org/1998/Math/MathML",It="http://www.w3.org/2000/svg",We="http://www.w3.org/1999/xhtml",Tt=We,jn=!1,En=["application/xhtml+xml","text/html"],Jn="text/html",ft=null,Qn=te.createElement("form"),Pt=function(i){return i instanceof RegExp||i instanceof Function},nn=function(i){ft&&ft===i||(i&&h(i)==="object"||(i={}),i=K(i),be="ALLOWED_TAGS"in i?$({},i.ALLOWED_TAGS):Zt,we="ALLOWED_ATTR"in i?$({},i.ALLOWED_ATTR):Vt,en="ADD_URI_SAFE_ATTR"in i?$(K(Ot),i.ADD_URI_SAFE_ATTR):Ot,Sn="ADD_DATA_URI_TAGS"in i?$(K(Ln),i.ADD_DATA_URI_TAGS):Ln,ut="FORBID_CONTENTS"in i?$({},i.FORBID_CONTENTS):An,bt="FORBID_TAGS"in i?$({},i.FORBID_TAGS):{},Wt="FORBID_ATTR"in i?$({},i.FORBID_ATTR):{},Ve="USE_PROFILES"in i&&i.USE_PROFILES,Yt=i.ALLOW_ARIA_ATTR!==!1,Jt=i.ALLOW_DATA_ATTR!==!1,kn=i.ALLOW_UNKNOWN_PROTOCOLS||!1,ct=i.SAFE_FOR_TEMPLATES||!1,oe=i.WHOLE_DOCUMENT||!1,tt=i.RETURN_DOM||!1,Ze=i.RETURN_DOM_FRAGMENT||!1,lt=i.RETURN_TRUSTED_TYPE||!1,Xt=i.FORCE_BODY||!1,Kt=i.SANITIZE_DOM!==!1,Et=i.KEEP_CONTENT!==!1,nt=i.IN_PLACE||!1,Gt=i.ALLOWED_URI_REGEXP||Gt,Tt=i.NAMESPACE||We,i.CUSTOM_ELEMENT_HANDLING&&Pt(i.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ue.tagNameCheck=i.CUSTOM_ELEMENT_HANDLING.tagNameCheck),i.CUSTOM_ELEMENT_HANDLING&&Pt(i.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ue.attributeNameCheck=i.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),i.CUSTOM_ELEMENT_HANDLING&&typeof i.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ue.allowCustomizedBuiltInElements=i.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),at=at=En.indexOf(i.PARSER_MEDIA_TYPE)===-1?Jn:i.PARSER_MEDIA_TYPE,Ge=at==="application/xhtml+xml"?function(I){return I}:ke,ct&&(Jt=!1),Ze&&(tt=!0),Ve&&(be=$({},C(je)),we=[],Ve.html===!0&&($(be,Oe),$(we,Ee)),Ve.svg===!0&&($(be,Le),$(we,Te),$(we,De)),Ve.svgFilters===!0&&($(be,Be),$(we,Te),$(we,De)),Ve.mathMl===!0&&($(be,ge),$(we,Me),$(we,De))),i.ADD_TAGS&&(be===Zt&&(be=K(be)),$(be,i.ADD_TAGS)),i.ADD_ATTR&&(we===Vt&&(we=K(we)),$(we,i.ADD_ATTR)),i.ADD_URI_SAFE_ATTR&&$(en,i.ADD_URI_SAFE_ATTR),i.FORBID_CONTENTS&&(ut===An&&(ut=K(ut)),$(ut,i.FORBID_CONTENTS)),Et&&(be["#text"]=!0),oe&&$(be,["html","head","body"]),be.table&&($(be,["tbody"]),delete bt.tbody),H&&H(i),ft=i)},rn=$({},["mi","mo","mn","ms","mtext"]),On=$({},["foreignobject","desc","title","annotation-xml"]),Xn=$({},["title","style","font","a","script"]),Ft=$({},Le);$(Ft,Be),$(Ft,ot);var on=$({},ge);$(on,de);var Kn=function(i){var I=st(i);I&&I.tagName||(I={namespaceURI:We,tagName:"template"});var j=ke(i.tagName),se=ke(I.tagName);return i.namespaceURI===It?I.namespaceURI===We?j==="svg":I.namespaceURI===tn?j==="svg"&&(se==="annotation-xml"||rn[se]):Boolean(Ft[j]):i.namespaceURI===tn?I.namespaceURI===We?j==="math":I.namespaceURI===It?j==="math"&&On[se]:Boolean(on[j]):i.namespaceURI===We&&!(I.namespaceURI===It&&!On[se])&&!(I.namespaceURI===tn&&!rn[se])&&!on[j]&&(Xn[j]||!Ft[j])},ze=function(i){ve(M.removed,{element:i});try{i.parentNode.removeChild(i)}catch{try{i.outerHTML=wn}catch{i.remove()}}},In=function(i,I){try{ve(M.removed,{attribute:I.getAttributeNode(i),from:I})}catch{ve(M.removed,{attribute:null,from:I})}if(I.removeAttribute(i),i==="is"&&!we[i])if(tt||Ze)try{ze(I)}catch{}else try{I.setAttribute(i,"")}catch{}},Tn=function(i){var I,j;if(Xt)i="<remove></remove>"+i;else{var se=Ae(i,/^[\r\n\t ]+/);j=se&&se[0]}at==="application/xhtml+xml"&&(i='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+i+"</body></html>");var pe=$e?$e.createHTML(i):i;if(Tt===We)try{I=new mn().parseFromString(pe,at)}catch{}if(!I||!I.documentElement){I=Ut.createDocument(Tt,"template",null);try{I.documentElement.innerHTML=jn?"":pe}catch{}}var xe=I.body||I.documentElement;return i&&j&&xe.insertBefore(te.createTextNode(j),xe.childNodes[0]||null),Tt===We?Yn.call(I,oe?"html":"body")[0]:oe?I.documentElement:xe},wt=function(i){return _n.call(i.ownerDocument||i,i,et.SHOW_ELEMENT|et.SHOW_COMMENT|et.SHOW_TEXT,null,!1)},er=function(i){return i instanceof Dt&&(typeof i.nodeName!="string"||typeof i.textContent!="string"||typeof i.removeChild!="function"||!(i.attributes instanceof Lt)||typeof i.removeAttribute!="function"||typeof i.setAttribute!="function"||typeof i.namespaceURI!="string"||typeof i.insertBefore!="function")},_t=function(i){return h(Ke)==="object"?i instanceof Ke:i&&h(i)==="object"&&typeof i.nodeType=="number"&&typeof i.nodeName=="string"},Ue=function(i,I,j){_e[i]&&re(_e[i],function(se){se.call(M,I,j,ft)})},sn=function(i){var I;if(Ue("beforeSanitizeElements",i,null),er(i)||k(/[\u0080-\uFFFF]/,i.nodeName))return ze(i),!0;var j=Ge(i.nodeName);if(Ue("uponSanitizeElement",i,{tagName:j,allowedTags:be}),i.hasChildNodes()&&!_t(i.firstElementChild)&&(!_t(i.content)||!_t(i.content.firstElementChild))&&k(/<[/\w]/g,i.innerHTML)&&k(/<[/\w]/g,i.textContent)||j==="select"&&k(/<template/i,i.innerHTML))return ze(i),!0;if(!be[j]||bt[j]){if(!bt[j]&&an(j)&&(ue.tagNameCheck instanceof RegExp&&k(ue.tagNameCheck,j)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(j)))return!1;if(Et&&!ut[j]){var se=st(i)||i.parentNode,pe=Wn(i)||i.childNodes;if(pe&&se)for(var xe=pe.length-1;xe>=0;--xe)se.insertBefore(vn(pe[xe],!0),bn(i))}return ze(i),!0}return i instanceof Re&&!Kn(i)?(ze(i),!0):j!=="noscript"&&j!=="noembed"||!k(/<\/no(script|embed)/i,i.innerHTML)?(ct&&i.nodeType===3&&(I=i.textContent,I=he(I,Ht," "),I=he(I,Bt," "),i.textContent!==I&&(ve(M.removed,{element:i.cloneNode()}),i.textContent=I)),Ue("afterSanitizeElements",i,null),!1):(ze(i),!0)},Pn=function(i,I,j){if(Kt&&(I==="id"||I==="name")&&(j in te||j in Qn))return!1;if(!(Jt&&!Wt[I]&&k(jt,I))){if(!(Yt&&k(Pe,I))){if(!we[I]||Wt[I]){if(!(an(i)&&(ue.tagNameCheck instanceof RegExp&&k(ue.tagNameCheck,i)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(i))&&(ue.attributeNameCheck instanceof RegExp&&k(ue.attributeNameCheck,I)||ue.attributeNameCheck instanceof Function&&ue.attributeNameCheck(I))||I==="is"&&ue.allowCustomizedBuiltInElements&&(ue.tagNameCheck instanceof RegExp&&k(ue.tagNameCheck,j)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(j))))return!1}else if(!en[I]){if(!k(Gt,he(j,vt,""))){if((I!=="src"&&I!=="xlink:href"&&I!=="href"||i==="script"||Fe(j,"data:")!==0||!Sn[i])&&!(kn&&!k($t,he(j,vt,"")))){if(j)return!1}}}}}return!0},an=function(i){return i.indexOf("-")>0},xt=function(i){var I,j,se,pe;Ue("beforeSanitizeAttributes",i,null);var xe=i.attributes;if(xe){var Ce={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:we};for(pe=xe.length;pe--;){var Ct=I=xe[pe],qe=Ct.name,ne=Ct.namespaceURI;if(j=qe==="value"?I.value:m(I.value),se=Ge(qe),Ce.attrName=se,Ce.attrValue=j,Ce.keepAttr=!0,Ce.forceKeepAttr=void 0,Ue("uponSanitizeAttribute",i,Ce),j=Ce.attrValue,!Ce.forceKeepAttr&&(In(qe,i),Ce.keepAttr))if(k(/\/>/i,j))In(qe,i);else{ct&&(j=he(j,Ht," "),j=he(j,Bt," "));var rt=Ge(i.nodeName);if(Pn(rt,se,j))try{ne?i.setAttributeNS(ne,qe,j):i.setAttribute(qe,j),ce(M.removed)}catch{}}}Ue("afterSanitizeAttributes",i,null)}},cn=function i(I){var j,se=wt(I);for(Ue("beforeSanitizeShadowDOM",I,null);j=se.nextNode();)Ue("uponSanitizeShadowNode",j,null),sn(j)||(j.content instanceof le&&i(j.content),xt(j));Ue("afterSanitizeShadowDOM",I,null)};return M.sanitize=function(i,I){var j,se,pe,xe,Ce;if((jn=!i)&&(i="<!-->"),typeof i!="string"&&!_t(i)){if(typeof i.toString!="function")throw B("toString is not a function");if(typeof(i=i.toString())!="string")throw B("dirty is not a string, aborting")}if(!M.isSupported){if(h(E.toStaticHTML)==="object"||typeof E.toStaticHTML=="function"){if(typeof i=="string")return E.toStaticHTML(i);if(_t(i))return E.toStaticHTML(i.outerHTML)}return i}if(Qt||nn(I),M.removed=[],typeof i=="string"&&(nt=!1),nt){if(i.nodeName){var Ct=Ge(i.nodeName);if(!be[Ct]||bt[Ct])throw B("root node is forbidden and cannot be sanitized in-place")}}else if(i instanceof Ke)(se=(j=Tn("<!---->")).ownerDocument.importNode(i,!0)).nodeType===1&&se.nodeName==="BODY"||se.nodeName==="HTML"?j=se:j.appendChild(se);else{if(!tt&&!ct&&!oe&&i.indexOf("<")===-1)return $e&&lt?$e.createHTML(i):i;if(!(j=Tn(i)))return tt?null:lt?wn:""}j&&Xt&&ze(j.firstChild);for(var qe=wt(nt?i:j);pe=qe.nextNode();)pe.nodeType===3&&pe===xe||sn(pe)||(pe.content instanceof le&&cn(pe.content),xt(pe),xe=pe);if(xe=null,nt)return i;if(tt){if(Ze)for(Ce=xn.call(j.ownerDocument);j.firstChild;)Ce.appendChild(j.firstChild);else Ce=j;return we.shadowroot&&(Ce=qt.call(Y,Ce,!0)),Ce}var ne=oe?j.outerHTML:j.innerHTML;return oe&&be["!doctype"]&&j.ownerDocument&&j.ownerDocument.doctype&&j.ownerDocument.doctype.name&&k(gn,j.ownerDocument.doctype.name)&&(ne="<!DOCTYPE "+j.ownerDocument.doctype.name+`>
`+ne),ct&&(ne=he(ne,Ht," "),ne=he(ne,Bt," ")),$e&&lt?$e.createHTML(ne):ne},M.setConfig=function(i){nn(i),Qt=!0},M.clearConfig=function(){ft=null,Qt=!1},M.isValidAttribute=function(i,I,j){ft||nn({});var se=Ge(i),pe=Ge(I);return Pn(se,pe,j)},M.addHook=function(i,I){typeof I=="function"&&(_e[i]=_e[i]||[],ve(_e[i],I))},M.removeHook=function(i){if(_e[i])return ce(_e[i])},M.removeHooks=function(i){_e[i]&&(_e[i]=[])},M.removeAllHooks=function(){_e={}},M}return ht()}()},729:O=>{var h=Object.prototype.hasOwnProperty,L="~";function P(){}function g(y,A,S){this.fn=y,this.context=A,this.once=S||!1}function C(y,A,S,G,q){if(typeof S!="function")throw new TypeError("The listener must be a function");var V=new g(S,G||y,q),Q=L?L+A:A;return y._events[Q]?y._events[Q].fn?y._events[Q]=[y._events[Q],V]:y._events[Q].push(V):(y._events[Q]=V,y._eventsCount++),y}function Z(y,A){--y._eventsCount==0?y._events=new P:delete y._events[A]}function x(){this._events=new P,this._eventsCount=0}Object.create&&(P.prototype=Object.create(null),new P().__proto__||(L=!1)),x.prototype.eventNames=function(){var y,A,S=[];if(this._eventsCount===0)return S;for(A in y=this._events)h.call(y,A)&&S.push(L?A.slice(1):A);return Object.getOwnPropertySymbols?S.concat(Object.getOwnPropertySymbols(y)):S},x.prototype.listeners=function(y){var A=L?L+y:y,S=this._events[A];if(!S)return[];if(S.fn)return[S.fn];for(var G=0,q=S.length,V=new Array(q);G<q;G++)V[G]=S[G].fn;return V},x.prototype.listenerCount=function(y){var A=L?L+y:y,S=this._events[A];return S?S.fn?1:S.length:0},x.prototype.emit=function(y,A,S,G,q,V){var Q=L?L+y:y;if(!this._events[Q])return!1;var R,H,c=this._events[Q],f=arguments.length;if(c.fn){switch(c.once&&this.removeListener(y,c.fn,void 0,!0),f){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,A),!0;case 3:return c.fn.call(c.context,A,S),!0;case 4:return c.fn.call(c.context,A,S,G),!0;case 5:return c.fn.call(c.context,A,S,G,q),!0;case 6:return c.fn.call(c.context,A,S,G,q,V),!0}for(H=1,R=new Array(f-1);H<f;H++)R[H-1]=arguments[H];c.fn.apply(c.context,R)}else{var w,T=c.length;for(H=0;H<T;H++)switch(c[H].once&&this.removeListener(y,c[H].fn,void 0,!0),f){case 1:c[H].fn.call(c[H].context);break;case 2:c[H].fn.call(c[H].context,A);break;case 3:c[H].fn.call(c[H].context,A,S);break;case 4:c[H].fn.call(c[H].context,A,S,G);break;default:if(!R)for(w=1,R=new Array(f-1);w<f;w++)R[w-1]=arguments[w];c[H].fn.apply(c[H].context,R)}}return!0},x.prototype.on=function(y,A,S){return C(this,y,A,S,!1)},x.prototype.once=function(y,A,S){return C(this,y,A,S,!0)},x.prototype.removeListener=function(y,A,S,G){var q=L?L+y:y;if(!this._events[q])return this;if(!A)return Z(this,q),this;var V=this._events[q];if(V.fn)V.fn!==A||G&&!V.once||S&&V.context!==S||Z(this,q);else{for(var Q=0,R=[],H=V.length;Q<H;Q++)(V[Q].fn!==A||G&&!V[Q].once||S&&V[Q].context!==S)&&R.push(V[Q]);R.length?this._events[q]=R.length===1?R[0]:R:Z(this,q)}return this},x.prototype.removeAllListeners=function(y){var A;return y?(A=L?L+y:y,this._events[A]&&Z(this,A)):(this._events=new P,this._eventsCount=0),this},x.prototype.off=x.prototype.removeListener,x.prototype.addListener=x.prototype.on,x.prefixed=L,x.EventEmitter=x,O.exports=x},717:O=>{typeof Object.create=="function"?O.exports=function(h,L){h.super_=L,h.prototype=Object.create(L.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}})}:O.exports=function(h,L){h.super_=L;var P=function(){};P.prototype=L.prototype,h.prototype=new P,h.prototype.constructor=h}},824:O=>{var h=1e3,L=60*h,P=60*L,g=24*P,C=7*g,Z=365.25*g;function x(y,A,S,G){var q=A>=1.5*S;return Math.round(y/S)+" "+G+(q?"s":"")}O.exports=function(y,A){A=A||{};var S=typeof y;if(S==="string"&&y.length>0)return function(G){if(!((G=String(G)).length>100)){var q=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(G);if(q){var V=parseFloat(q[1]);switch((q[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return V*Z;case"weeks":case"week":case"w":return V*C;case"days":case"day":case"d":return V*g;case"hours":case"hour":case"hrs":case"hr":case"h":return V*P;case"minutes":case"minute":case"mins":case"min":case"m":return V*L;case"seconds":case"second":case"secs":case"sec":case"s":return V*h;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return V;default:return}}}}(y);if(S==="number"&&isFinite(y))return A.long?function(G){var q=Math.abs(G);return q>=g?x(G,q,g,"day"):q>=P?x(G,q,P,"hour"):q>=L?x(G,q,L,"minute"):q>=h?x(G,q,h,"second"):G+" ms"}(y):function(G){var q=Math.abs(G);return q>=g?Math.round(G/g)+"d":q>=P?Math.round(G/P)+"h":q>=L?Math.round(G/L)+"m":q>=h?Math.round(G/h)+"s":G+"ms"}(y);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(y))}},520:(O,h,L)=>{var P=L(155),g=P.platform==="win32",C=L(539);function Z(c,f){for(var w=[],T=0;T<c.length;T++){var X=c[T];X&&X!=="."&&(X===".."?w.length&&w[w.length-1]!==".."?w.pop():f&&w.push(".."):w.push(X))}return w}function x(c){for(var f=c.length-1,w=0;w<=f&&!c[w];w++);for(var T=f;T>=0&&!c[T];T--);return w===0&&T===f?c:w>T?[]:c.slice(w,T+1)}var y=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,A=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,S={};function G(c){var f=y.exec(c),w=(f[1]||"")+(f[2]||""),T=f[3]||"",X=A.exec(T);return[w,X[1],X[2],X[3]]}function q(c){var f=y.exec(c),w=f[1]||"",T=!!w&&w[1]!==":";return{device:w,isUnc:T,isAbsolute:T||!!f[2],tail:f[3]}}function V(c){return"\\\\"+c.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}S.resolve=function(){for(var c="",f="",w=!1,T=arguments.length-1;T>=-1;T--){var X;if(T>=0?X=arguments[T]:c?(X=P.env["="+c])&&X.substr(0,3).toLowerCase()===c.toLowerCase()+"\\"||(X=c+"\\"):X=P.cwd(),!C.isString(X))throw new TypeError("Arguments to path.resolve must be strings");if(X){var re=q(X),ce=re.device,ve=re.isUnc,ke=re.isAbsolute,Ae=re.tail;if((!ce||!c||ce.toLowerCase()===c.toLowerCase())&&(c||(c=ce),w||(f=Ae+"\\"+f,w=ke),c&&w))break}}return ve&&(c=V(c)),c+(w?"\\":"")+(f=Z(f.split(/[\\\/]+/),!w).join("\\"))||"."},S.normalize=function(c){var f=q(c),w=f.device,T=f.isUnc,X=f.isAbsolute,re=f.tail,ce=/[\\\/]$/.test(re);return(re=Z(re.split(/[\\\/]+/),!X).join("\\"))||X||(re="."),re&&ce&&(re+="\\"),T&&(w=V(w)),w+(X?"\\":"")+re},S.isAbsolute=function(c){return q(c).isAbsolute},S.join=function(){for(var c=[],f=0;f<arguments.length;f++){var w=arguments[f];if(!C.isString(w))throw new TypeError("Arguments to path.join must be strings");w&&c.push(w)}var T=c.join("\\");return/^[\\\/]{2}[^\\\/]/.test(c[0])||(T=T.replace(/^[\\\/]{2,}/,"\\")),S.normalize(T)},S.relative=function(c,f){c=S.resolve(c),f=S.resolve(f);for(var w=c.toLowerCase(),T=f.toLowerCase(),X=x(f.split("\\")),re=x(w.split("\\")),ce=x(T.split("\\")),ve=Math.min(re.length,ce.length),ke=ve,Ae=0;Ae<ve;Ae++)if(re[Ae]!==ce[Ae]){ke=Ae;break}if(ke==0)return f;var he=[];for(Ae=ke;Ae<re.length;Ae++)he.push("..");return(he=he.concat(X.slice(ke))).join("\\")},S._makeLong=function(c){if(!C.isString(c))return c;if(!c)return"";var f=S.resolve(c);return/^[a-zA-Z]\:\\/.test(f)?"\\\\?\\"+f:/^\\\\[^?.]/.test(f)?"\\\\?\\UNC\\"+f.substring(2):c},S.dirname=function(c){var f=G(c),w=f[0],T=f[1];return w||T?(T&&(T=T.substr(0,T.length-1)),w+T):"."},S.basename=function(c,f){var w=G(c)[2];return f&&w.substr(-1*f.length)===f&&(w=w.substr(0,w.length-f.length)),w},S.extname=function(c){return G(c)[3]},S.format=function(c){if(!C.isObject(c))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof c);var f=c.root||"";if(!C.isString(f))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof c.root);var w=c.dir,T=c.base||"";return w?w[w.length-1]===S.sep?w+T:w+S.sep+T:T},S.parse=function(c){if(!C.isString(c))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof c);var f=G(c);if(!f||f.length!==4)throw new TypeError("Invalid path '"+c+"'");return{root:f[0],dir:f[0]+f[1].slice(0,-1),base:f[2],ext:f[3],name:f[2].slice(0,f[2].length-f[3].length)}},S.sep="\\",S.delimiter=";";var Q=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,R={};function H(c){return Q.exec(c).slice(1)}R.resolve=function(){for(var c="",f=!1,w=arguments.length-1;w>=-1&&!f;w--){var T=w>=0?arguments[w]:P.cwd();if(!C.isString(T))throw new TypeError("Arguments to path.resolve must be strings");T&&(c=T+"/"+c,f=T[0]==="/")}return(f?"/":"")+(c=Z(c.split("/"),!f).join("/"))||"."},R.normalize=function(c){var f=R.isAbsolute(c),w=c&&c[c.length-1]==="/";return(c=Z(c.split("/"),!f).join("/"))||f||(c="."),c&&w&&(c+="/"),(f?"/":"")+c},R.isAbsolute=function(c){return c.charAt(0)==="/"},R.join=function(){for(var c="",f=0;f<arguments.length;f++){var w=arguments[f];if(!C.isString(w))throw new TypeError("Arguments to path.join must be strings");w&&(c+=c?"/"+w:w)}return R.normalize(c)},R.relative=function(c,f){c=R.resolve(c).substr(1),f=R.resolve(f).substr(1);for(var w=x(c.split("/")),T=x(f.split("/")),X=Math.min(w.length,T.length),re=X,ce=0;ce<X;ce++)if(w[ce]!==T[ce]){re=ce;break}var ve=[];for(ce=re;ce<w.length;ce++)ve.push("..");return(ve=ve.concat(T.slice(re))).join("/")},R._makeLong=function(c){return c},R.dirname=function(c){var f=H(c),w=f[0],T=f[1];return w||T?(T&&(T=T.substr(0,T.length-1)),w+T):"."},R.basename=function(c,f){var w=H(c)[2];return f&&w.substr(-1*f.length)===f&&(w=w.substr(0,w.length-f.length)),w},R.extname=function(c){return H(c)[3]},R.format=function(c){if(!C.isObject(c))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof c);var f=c.root||"";if(!C.isString(f))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof c.root);return(c.dir?c.dir+R.sep:"")+(c.base||"")},R.parse=function(c){if(!C.isString(c))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof c);var f=H(c);if(!f||f.length!==4)throw new TypeError("Invalid path '"+c+"'");return f[1]=f[1]||"",f[2]=f[2]||"",f[3]=f[3]||"",{root:f[0],dir:f[0]+f[1].slice(0,-1),base:f[2],ext:f[3],name:f[2].slice(0,f[2].length-f[3].length)}},R.sep="/",R.delimiter=":",O.exports=g?S:R,O.exports.posix=R,O.exports.win32=S},155:O=>{var h,L,P=O.exports={};function g(){throw new Error("setTimeout has not been defined")}function C(){throw new Error("clearTimeout has not been defined")}function Z(R){if(h===setTimeout)return setTimeout(R,0);if((h===g||!h)&&setTimeout)return h=setTimeout,setTimeout(R,0);try{return h(R,0)}catch{try{return h.call(null,R,0)}catch{return h.call(this,R,0)}}}(function(){try{h=typeof setTimeout=="function"?setTimeout:g}catch{h=g}try{L=typeof clearTimeout=="function"?clearTimeout:C}catch{L=C}})();var x,y=[],A=!1,S=-1;function G(){A&&x&&(A=!1,x.length?y=x.concat(y):S=-1,y.length&&q())}function q(){if(!A){var R=Z(G);A=!0;for(var H=y.length;H;){for(x=y,y=[];++S<H;)x&&x[S].run();S=-1,H=y.length}x=null,A=!1,function(c){if(L===clearTimeout)return clearTimeout(c);if((L===C||!L)&&clearTimeout)return L=clearTimeout,clearTimeout(c);try{L(c)}catch{try{return L.call(null,c)}catch{return L.call(this,c)}}}(R)}}function V(R,H){this.fun=R,this.array=H}function Q(){}P.nextTick=function(R){var H=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)H[c-1]=arguments[c];y.push(new V(R,H)),y.length!==1||A||Z(q)},V.prototype.run=function(){this.fun.apply(null,this.array)},P.title="browser",P.browser=!0,P.env={},P.argv=[],P.version="",P.versions={},P.on=Q,P.addListener=Q,P.once=Q,P.off=Q,P.removeListener=Q,P.removeAllListeners=Q,P.emit=Q,P.prependListener=Q,P.prependOnceListener=Q,P.listeners=function(R){return[]},P.binding=function(R){throw new Error("process.binding is not supported")},P.cwd=function(){return"/"},P.chdir=function(R){throw new Error("process.chdir is not supported")},P.umask=function(){return 0}},384:O=>{O.exports=function(h){return h&&typeof h=="object"&&typeof h.copy=="function"&&typeof h.fill=="function"&&typeof h.readUInt8=="function"}},539:(O,h,L)=>{var P=L(155),g=/%[sdj%]/g;h.format=function(m){if(!c(m)){for(var k=[],B=0;B<arguments.length;B++)k.push(x(arguments[B]));return k.join(" ")}B=1;for(var ie=arguments,Se=ie.length,$=String(m).replace(g,function(fe){if(fe==="%%")return"%";if(B>=Se)return fe;switch(fe){case"%s":return String(ie[B++]);case"%d":return Number(ie[B++]);case"%j":try{return JSON.stringify(ie[B++])}catch{return"[Circular]"}default:return fe}}),K=ie[B];B<Se;K=ie[++B])R(K)||!T(K)?$+=" "+K:$+=" "+x(K);return $},h.deprecate=function(m,k){if(f(L.g.process))return function(){return h.deprecate(m,k).apply(this,arguments)};if(P.noDeprecation===!0)return m;var B=!1;return function(){if(!B){if(P.throwDeprecation)throw new Error(k);P.traceDeprecation?console.trace(k):console.error(k),B=!0}return m.apply(this,arguments)}};var C,Z={};function x(m,k){var B={seen:[],stylize:A};return arguments.length>=3&&(B.depth=arguments[2]),arguments.length>=4&&(B.colors=arguments[3]),Q(k)?B.showHidden=k:k&&h._extend(B,k),f(B.showHidden)&&(B.showHidden=!1),f(B.depth)&&(B.depth=2),f(B.colors)&&(B.colors=!1),f(B.customInspect)&&(B.customInspect=!0),B.colors&&(B.stylize=y),S(B,m,B.depth)}function y(m,k){var B=x.styles[k];return B?"\x1B["+x.colors[B][0]+"m"+m+"\x1B["+x.colors[B][1]+"m":m}function A(m,k){return m}function S(m,k,B){if(m.customInspect&&k&&ce(k.inspect)&&k.inspect!==h.inspect&&(!k.constructor||k.constructor.prototype!==k)){var ie=k.inspect(B,m);return c(ie)||(ie=S(m,ie,B)),ie}var Se=function(ge,de){if(f(de))return ge.stylize("undefined","undefined");if(c(de)){var je="'"+JSON.stringify(de).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ge.stylize(je,"string")}if(H(de))return ge.stylize(""+de,"number");if(Q(de))return ge.stylize(""+de,"boolean");if(R(de))return ge.stylize("null","null")}(m,k);if(Se)return Se;var $=Object.keys(k),K=function(ge){var de={};return ge.forEach(function(je,Ee){de[je]=!0}),de}($);if(m.showHidden&&($=Object.getOwnPropertyNames(k)),re(k)&&($.indexOf("message")>=0||$.indexOf("description")>=0))return G(k);if($.length===0){if(ce(k)){var fe=k.name?": "+k.name:"";return m.stylize("[Function"+fe+"]","special")}if(w(k))return m.stylize(RegExp.prototype.toString.call(k),"regexp");if(X(k))return m.stylize(Date.prototype.toString.call(k),"date");if(re(k))return G(k)}var Oe,Le="",Be=!1,ot=["{","}"];return V(k)&&(Be=!0,ot=["[","]"]),ce(k)&&(Le=" [Function"+(k.name?": "+k.name:"")+"]"),w(k)&&(Le=" "+RegExp.prototype.toString.call(k)),X(k)&&(Le=" "+Date.prototype.toUTCString.call(k)),re(k)&&(Le=" "+G(k)),$.length!==0||Be&&k.length!=0?B<0?w(k)?m.stylize(RegExp.prototype.toString.call(k),"regexp"):m.stylize("[Object]","special"):(m.seen.push(k),Oe=Be?function(ge,de,je,Ee,Te){for(var Me=[],De=0,Rt=de.length;De<Rt;++De)Fe(de,String(De))?Me.push(q(ge,de,je,Ee,String(De),!0)):Me.push("");return Te.forEach(function(St){St.match(/^\d+$/)||Me.push(q(ge,de,je,Ee,St,!0))}),Me}(m,k,B,K,$):$.map(function(ge){return q(m,k,B,K,ge,Be)}),m.seen.pop(),function(ge,de,je){return ge.reduce(function(Ee,Te){return Te.indexOf(`
`)>=0,Ee+Te.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?je[0]+(de===""?"":de+`
 `)+" "+ge.join(`,
  `)+" "+je[1]:je[0]+de+" "+ge.join(", ")+" "+je[1]}(Oe,Le,ot)):ot[0]+Le+ot[1]}function G(m){return"["+Error.prototype.toString.call(m)+"]"}function q(m,k,B,ie,Se,$){var K,fe,Oe;if((Oe=Object.getOwnPropertyDescriptor(k,Se)||{value:k[Se]}).get?fe=Oe.set?m.stylize("[Getter/Setter]","special"):m.stylize("[Getter]","special"):Oe.set&&(fe=m.stylize("[Setter]","special")),Fe(ie,Se)||(K="["+Se+"]"),fe||(m.seen.indexOf(Oe.value)<0?(fe=R(B)?S(m,Oe.value,null):S(m,Oe.value,B-1)).indexOf(`
`)>-1&&(fe=$?fe.split(`
`).map(function(Le){return"  "+Le}).join(`
`).substr(2):`
`+fe.split(`
`).map(function(Le){return"   "+Le}).join(`
`)):fe=m.stylize("[Circular]","special")),f(K)){if($&&Se.match(/^\d+$/))return fe;(K=JSON.stringify(""+Se)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(K=K.substr(1,K.length-2),K=m.stylize(K,"name")):(K=K.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),K=m.stylize(K,"string"))}return K+": "+fe}function V(m){return Array.isArray(m)}function Q(m){return typeof m=="boolean"}function R(m){return m===null}function H(m){return typeof m=="number"}function c(m){return typeof m=="string"}function f(m){return m===void 0}function w(m){return T(m)&&ve(m)==="[object RegExp]"}function T(m){return typeof m=="object"&&m!==null}function X(m){return T(m)&&ve(m)==="[object Date]"}function re(m){return T(m)&&(ve(m)==="[object Error]"||m instanceof Error)}function ce(m){return typeof m=="function"}function ve(m){return Object.prototype.toString.call(m)}function ke(m){return m<10?"0"+m.toString(10):m.toString(10)}h.debuglog=function(m){if(f(C)&&(C=P.env.NODE_DEBUG||""),m=m.toUpperCase(),!Z[m])if(new RegExp("\\b"+m+"\\b","i").test(C)){var k=P.pid;Z[m]=function(){var B=h.format.apply(h,arguments);console.error("%s %d: %s",m,k,B)}}else Z[m]=function(){};return Z[m]},h.inspect=x,x.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},x.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},h.isArray=V,h.isBoolean=Q,h.isNull=R,h.isNullOrUndefined=function(m){return m==null},h.isNumber=H,h.isString=c,h.isSymbol=function(m){return typeof m=="symbol"},h.isUndefined=f,h.isRegExp=w,h.isObject=T,h.isDate=X,h.isError=re,h.isFunction=ce,h.isPrimitive=function(m){return m===null||typeof m=="boolean"||typeof m=="number"||typeof m=="string"||typeof m=="symbol"||m===void 0},h.isBuffer=L(384);var Ae=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function he(){var m=new Date,k=[ke(m.getHours()),ke(m.getMinutes()),ke(m.getSeconds())].join(":");return[m.getDate(),Ae[m.getMonth()],k].join(" ")}function Fe(m,k){return Object.prototype.hasOwnProperty.call(m,k)}h.log=function(){console.log("%s - %s",he(),h.format.apply(h,arguments))},h.inherits=L(717),h._extend=function(m,k){if(!k||!T(k))return m;for(var B=Object.keys(k),ie=B.length;ie--;)m[B[ie]]=k[B[ie]];return m}}},b={};function _(O){var h=b[O];if(h!==void 0)return h.exports;var L=b[O]={exports:{}};return u[O].call(L.exports,L,L.exports,_),L.exports}_.n=O=>{var h=O&&O.__esModule?()=>O.default:()=>O;return _.d(h,{a:h}),h},_.d=(O,h)=>{for(var L in h)_.o(h,L)&&!_.o(O,L)&&Object.defineProperty(O,L,{enumerable:!0,get:h[L]})},_.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),_.o=(O,h)=>Object.prototype.hasOwnProperty.call(O,h),_.r=O=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(O,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(O,"__esModule",{value:!0})};var F={};return(()=>{_.r(F),_.d(F,{LSPluginUser:()=>pr,setupPluginUserInstance:()=>Jr});var O=_(520);_(856);const h=function(){this.__data__=[],this.size=0},L=function(t,e){return t===e||t!=t&&e!=e},P=function(t,e){for(var n=t.length;n--;)if(L(t[n][0],e))return n;return-1};var g=Array.prototype.splice;const C=function(t){var e=this.__data__,n=P(e,t);return!(n<0)&&(n==e.length-1?e.pop():g.call(e,n,1),--this.size,!0)},Z=function(t){var e=this.__data__,n=P(e,t);return n<0?void 0:e[n][1]},x=function(t){return P(this.__data__,t)>-1},y=function(t,e){var n=this.__data__,r=P(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};function A(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}A.prototype.clear=h,A.prototype.delete=C,A.prototype.get=Z,A.prototype.has=x,A.prototype.set=y;const S=A,G=function(){this.__data__=new S,this.size=0},q=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},V=function(t){return this.__data__.get(t)},Q=function(t){return this.__data__.has(t)},R=typeof fn=="object"&&fn&&fn.Object===Object&&fn;var H=typeof self=="object"&&self&&self.Object===Object&&self;const c=R||H||Function("return this")(),f=c.Symbol;var w=Object.prototype,T=w.hasOwnProperty,X=w.toString,re=f?f.toStringTag:void 0;const ce=function(t){var e=T.call(t,re),n=t[re];try{t[re]=void 0;var r=!0}catch{}var s=X.call(t);return r&&(e?t[re]=n:delete t[re]),s};var ve=Object.prototype.toString;const ke=function(t){return ve.call(t)};var Ae=f?f.toStringTag:void 0;const he=function(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Ae&&Ae in Object(t)?ce(t):ke(t)},Fe=function(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")},m=function(t){if(!Fe(t))return!1;var e=he(t);return e=="[object Function]"||e=="[object GeneratorFunction]"||e=="[object AsyncFunction]"||e=="[object Proxy]"},k=c["__core-js_shared__"];var B,ie=(B=/[^.]+$/.exec(k&&k.keys&&k.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"";const Se=function(t){return!!ie&&ie in t};var $=Function.prototype.toString;const K=function(t){if(t!=null){try{return $.call(t)}catch{}try{return t+""}catch{}}return""};var fe=/^\[object .+?Constructor\]$/,Oe=Function.prototype,Le=Object.prototype,Be=Oe.toString,ot=Le.hasOwnProperty,ge=RegExp("^"+Be.call(ot).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const de=function(t){return!(!Fe(t)||Se(t))&&(m(t)?ge:fe).test(K(t))},je=function(t,e){return t?.[e]},Ee=function(t,e){var n=je(t,e);return de(n)?n:void 0},Te=Ee(c,"Map"),Me=Ee(Object,"create"),De=function(){this.__data__=Me?Me(null):{},this.size=0},Rt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e};var St=Object.prototype.hasOwnProperty;const Hn=function(t){var e=this.__data__;if(Me){var n=e[t];return n==="__lodash_hash_undefined__"?void 0:n}return St.call(e,t)?e[t]:void 0};var Bn=Object.prototype.hasOwnProperty;const $n=function(t){var e=this.__data__;return Me?e[t]!==void 0:Bn.call(e,t)},Gn=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Me&&e===void 0?"__lodash_hash_undefined__":e,this};function it(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}it.prototype.clear=De,it.prototype.delete=Rt,it.prototype.get=Hn,it.prototype.has=$n,it.prototype.set=Gn;const gn=it,Zn=function(){this.size=0,this.__data__={hash:new gn,map:new(Te||S),string:new gn}},Vn=function(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null},ht=function(t,e){var n=t.__data__;return Vn(e)?n[typeof e=="string"?"string":"hash"]:n.map},E=function(t){var e=ht(this,t).delete(t);return this.size-=e?1:0,e},M=function(t){return ht(this,t).get(t)},Y=function(t){return ht(this,t).has(t)},te=function(t,e){var n=ht(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function le(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}le.prototype.clear=Zn,le.prototype.delete=E,le.prototype.get=M,le.prototype.has=Y,le.prototype.set=te;const Ne=le,Ke=function(t,e){var n=this.__data__;if(n instanceof S){var r=n.__data__;if(!Te||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Ne(r)}return n.set(t,e),this.size=n.size,this};function Re(t){var e=this.__data__=new S(t);this.size=e.size}Re.prototype.clear=G,Re.prototype.delete=q,Re.prototype.get=V,Re.prototype.has=Q,Re.prototype.set=Ke;const et=Re,gt=function(){try{var t=Ee(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Lt=function(t,e,n){e=="__proto__"&&gt?gt(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},Dt=function(t,e,n){(n!==void 0&&!L(t[e],n)||n===void 0&&!(e in t))&&Lt(t,e,n)},mn=function(t){return function(e,n,r){for(var s=-1,l=Object(e),d=r(e),p=d.length;p--;){var v=d[t?p:++s];if(n(l[v],v,l)===!1)break}return e}}();var yn=a&&!a.nodeType&&a,mt=yn&&!0&&o&&!o.nodeType&&o,vn=mt&&mt.exports===yn?c.Buffer:void 0,bn=vn?vn.allocUnsafe:void 0;const Wn=function(t,e){if(e)return t.slice();var n=t.length,r=bn?bn(n):new t.constructor(n);return t.copy(r),r},st=c.Uint8Array,zt=function(t){var e=new t.constructor(t.byteLength);return new st(e).set(new st(t)),e},$e=function(t,e){var n=e?zt(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)},wn=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e};var yt=Object.create;const Ut=function(){function t(){}return function(e){if(!Fe(e))return{};if(yt)return yt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),_n=function(t,e){return function(n){return t(e(n))}},xn=_n(Object.getPrototypeOf,Object);var Yn=Object.prototype;const qt=function(t){var e=t&&t.constructor;return t===(typeof e=="function"&&e.prototype||Yn)},Cn=function(t){return typeof t.constructor!="function"||qt(t)?{}:Ut(xn(t))},_e=function(t){return t!=null&&typeof t=="object"},at=function(t){return _e(t)&&he(t)=="[object Arguments]"};var Ge=Object.prototype,Ht=Ge.hasOwnProperty,Bt=Ge.propertyIsEnumerable;const jt=at(function(){return arguments}())?at:function(t){return _e(t)&&Ht.call(t,"callee")&&!Bt.call(t,"callee")},Pe=Array.isArray,$t=function(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=9007199254740991},vt=function(t){return t!=null&&$t(t.length)&&!m(t)},Gt=function(t){return _e(t)&&vt(t)},be=function(){return!1};var Zt=a&&!a.nodeType&&a,we=Zt&&!0&&o&&!o.nodeType&&o,Vt=we&&we.exports===Zt?c.Buffer:void 0;const ue=(Vt?Vt.isBuffer:void 0)||be;var bt=Function.prototype,Wt=Object.prototype,Yt=bt.toString,Jt=Wt.hasOwnProperty,kn=Yt.call(Object);const ct=function(t){if(!_e(t)||he(t)!="[object Object]")return!1;var e=xn(t);if(e===null)return!0;var n=Jt.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&Yt.call(n)==kn};var oe={};oe["[object Float32Array]"]=oe["[object Float64Array]"]=oe["[object Int8Array]"]=oe["[object Int16Array]"]=oe["[object Int32Array]"]=oe["[object Uint8Array]"]=oe["[object Uint8ClampedArray]"]=oe["[object Uint16Array]"]=oe["[object Uint32Array]"]=!0,oe["[object Arguments]"]=oe["[object Array]"]=oe["[object ArrayBuffer]"]=oe["[object Boolean]"]=oe["[object DataView]"]=oe["[object Date]"]=oe["[object Error]"]=oe["[object Function]"]=oe["[object Map]"]=oe["[object Number]"]=oe["[object Object]"]=oe["[object RegExp]"]=oe["[object Set]"]=oe["[object String]"]=oe["[object WeakMap]"]=!1;const Qt=function(t){return _e(t)&&$t(t.length)&&!!oe[he(t)]},Xt=function(t){return function(e){return t(e)}};var tt=a&&!a.nodeType&&a,Ze=tt&&!0&&o&&!o.nodeType&&o,lt=Ze&&Ze.exports===tt&&R.process,Kt=function(){try{var t=Ze&&Ze.require&&Ze.require("util").types;return t||lt&&lt.binding&&lt.binding("util")}catch{}}(),Et=Kt&&Kt.isTypedArray;const nt=Et?Xt(Et):Qt,Ve=function(t,e){if((e!=="constructor"||typeof t[e]!="function")&&e!="__proto__")return t[e]};var ut=Object.prototype.hasOwnProperty;const An=function(t,e,n){var r=t[e];ut.call(t,e)&&L(r,n)&&(n!==void 0||e in t)||Lt(t,e,n)},Sn=function(t,e,n,r){var s=!n;n||(n={});for(var l=-1,d=e.length;++l<d;){var p=e[l],v=r?r(n[p],t[p],p,n,t):void 0;v===void 0&&(v=t[p]),s?Lt(n,p,v):An(n,p,v)}return n},Ln=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r};var en=/^(?:0|[1-9]\d*)$/;const Ot=function(t,e){var n=typeof t;return!!(e=e??9007199254740991)&&(n=="number"||n!="symbol"&&en.test(t))&&t>-1&&t%1==0&&t<e};var tn=Object.prototype.hasOwnProperty;const It=function(t,e){var n=Pe(t),r=!n&&jt(t),s=!n&&!r&&ue(t),l=!n&&!r&&!s&&nt(t),d=n||r||s||l,p=d?Ln(t.length,String):[],v=p.length;for(var D in t)!e&&!tn.call(t,D)||d&&(D=="length"||s&&(D=="offset"||D=="parent")||l&&(D=="buffer"||D=="byteLength"||D=="byteOffset")||Ot(D,v))||p.push(D);return p},We=function(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e};var Tt=Object.prototype.hasOwnProperty;const jn=function(t){if(!Fe(t))return We(t);var e=qt(t),n=[];for(var r in t)(r!="constructor"||!e&&Tt.call(t,r))&&n.push(r);return n},En=function(t){return vt(t)?It(t,!0):jn(t)},Jn=function(t){return Sn(t,En(t))},ft=function(t,e,n,r,s,l,d){var p=Ve(t,n),v=Ve(e,n),D=d.get(v);if(D)Dt(t,n,D);else{var z=l?l(p,v,n+"",t,e,d):void 0,U=z===void 0;if(U){var W=Pe(v),ee=!W&&ue(v),J=!W&&!ee&&nt(v);z=v,W||ee||J?Pe(p)?z=p:Gt(p)?z=wn(p):ee?(U=!1,z=Wn(v,!0)):J?(U=!1,z=$e(v,!0)):z=[]:ct(v)||jt(v)?(z=p,jt(p)?z=Jn(p):Fe(p)&&!m(p)||(z=Cn(v))):U=!1}U&&(d.set(v,z),s(z,v,r,l,d),d.delete(v)),Dt(t,n,z)}},Qn=function t(e,n,r,s,l){e!==n&&mn(n,function(d,p){if(l||(l=new et),Fe(d))ft(e,n,p,r,t,s,l);else{var v=s?s(Ve(e,p),d,p+"",e,n,l):void 0;v===void 0&&(v=d),Dt(e,p,v)}},En)},Pt=function(t){return t},nn=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)};var rn=Math.max;const On=function(t,e,n){return e=rn(e===void 0?t.length-1:e,0),function(){for(var r=arguments,s=-1,l=rn(r.length-e,0),d=Array(l);++s<l;)d[s]=r[e+s];s=-1;for(var p=Array(e+1);++s<e;)p[s]=r[s];return p[e]=n(d),nn(t,this,p)}},Xn=function(t){return function(){return t}},Ft=gt?function(t,e){return gt(t,"toString",{configurable:!0,enumerable:!1,value:Xn(e),writable:!0})}:Pt;var on=Date.now;const Kn=function(t){var e=0,n=0;return function(){var r=on(),s=16-(r-n);if(n=r,s>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Ft),ze=function(t,e){return Kn(On(t,e,Pt),t+"")},In=function(t,e,n){if(!Fe(n))return!1;var r=typeof e;return!!(r=="number"?vt(n)&&Ot(e,n.length):r=="string"&&e in n)&&L(n[e],t)},Tn=function(t){return ze(function(e,n){var r=-1,s=n.length,l=s>1?n[s-1]:void 0,d=s>2?n[2]:void 0;for(l=t.length>3&&typeof l=="function"?(s--,l):void 0,d&&In(n[0],n[1],d)&&(l=s<3?void 0:l,s=1),e=Object(e);++r<s;){var p=n[r];p&&t(e,p,r,l)}return e})}(function(t,e,n){Qn(t,e,n)});var wt=function(){return wt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},wt.apply(this,arguments)};function er(t){return t.toLowerCase()}var _t=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],Ue=/[^A-Z0-9]+/gi;function sn(t,e,n){return e instanceof RegExp?t.replace(e,n):e.reduce(function(r,s){return r.replace(s,n)},t)}function Pn(t,e){return e===void 0&&(e={}),function(n,r){r===void 0&&(r={});for(var s=r.splitRegexp,l=s===void 0?_t:s,d=r.stripRegexp,p=d===void 0?Ue:d,v=r.transform,D=v===void 0?er:v,z=r.delimiter,U=z===void 0?" ":z,W=sn(sn(n,l,"$1\0$2"),p,"\0"),ee=0,J=W.length;W.charAt(ee)==="\0";)ee++;for(;W.charAt(J-1)==="\0";)J--;return W.slice(ee,J).split("\0").map(D).join(U)}(t,wt({delimiter:"."},e))}var an=_(729),xt=_.n(an);function cn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const i=navigator.platform.toLowerCase()==="win32"?O.win32:O.posix,I=function(t,e){return e===void 0&&(e={}),Pn(t,wt({delimiter:"_"},e))},j=Tn;class se extends xt(){constructor(e,n){super(),cn(this,"_tag",void 0),cn(this,"_opts",void 0),cn(this,"_logs",[]),this._tag=e,this._opts=n}write(e,n,r){var s;n!=null&&n.length&&n[n.length-1]===!0&&(r=!0,n.pop());const l=n.reduce((p,v)=>(v&&v instanceof Error?p+=`${v.message} ${v.stack}`:p+=v.toString(),p),`[${this._tag}][${new Date().toLocaleTimeString()}] `);var d;this._logs.push([e,l]),(r||(s=this._opts)!==null&&s!==void 0&&s.console)&&((d=console)===null||d===void 0||d[e==="ERROR"?"error":"debug"](`${e}: ${l}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...e){this.write("INFO",e)}error(...e){this.write("ERROR",e)}warn(...e){this.write("WARN",e)}setTag(e){this._tag=e}toJSON(){return this._logs}}function pe(t,...e){try{const n=new URL(t);if(!n.origin)throw new Error(null);const r=i.join(t.substr(n.origin.length),...e);return n.origin+r}catch{return i.join(t,...e)}}function xe(t,e){let n,r,s=!1;const l=p=>v=>{t&&clearTimeout(t),p(v),s=!0},d=new Promise((p,v)=>{n=l(p),r=l(v),t&&(t=setTimeout(()=>r(new Error(`[deferred timeout] ${e}`)),t))});return{created:Date.now(),setTag:p=>e=p,resolve:n,reject:r,promise:d,get settled(){return s}}}const Ce=new Map;window.__injectedUIEffects=Ce;var Ct=_(227),qe=_.n(Ct);function ne(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const rt="application/x-postmate-v1+json";let wr=0;const xo={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},tr=(t,e)=>(typeof e!="string"||t.origin===e)&&!!t.data&&(typeof t.data!="object"||"postmate"in t.data)&&t.data.type===rt&&!!xo[t.data.postmate];class Co{constructor(e){ne(this,"parent",void 0),ne(this,"frame",void 0),ne(this,"child",void 0),ne(this,"events",{}),ne(this,"childOrigin",void 0),ne(this,"listener",void 0),this.parent=e.parent,this.frame=e.frame,this.child=e.child,this.childOrigin=e.childOrigin,this.listener=n=>{if(!tr(n,this.childOrigin))return!1;const{data:r,name:s}=((n||{}).data||{}).value||{};n.data.postmate==="emit"&&s in this.events&&this.events[s].forEach(l=>{l.call(this,r)})},this.parent.addEventListener("message",this.listener,!1)}get(e,...n){return new Promise(r=>{const s=++wr,l=d=>{d.data.uid===s&&d.data.postmate==="reply"&&(this.parent.removeEventListener("message",l,!1),r(d.data.value))};this.parent.addEventListener("message",l,!1),this.child.postMessage({postmate:"request",type:rt,property:e,args:n,uid:s},this.childOrigin)})}call(e,n){this.child.postMessage({postmate:"call",type:rt,property:e,data:n},this.childOrigin)}on(e,n){this.events[e]||(this.events[e]=[]),this.events[e].push(n)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class ko{constructor(e){ne(this,"model",void 0),ne(this,"parent",void 0),ne(this,"parentOrigin",void 0),ne(this,"child",void 0),this.model=e.model,this.parent=e.parent,this.parentOrigin=e.parentOrigin,this.child=e.child,this.child.addEventListener("message",n=>{if(!tr(n,this.parentOrigin))return;const{property:r,uid:s,data:l,args:d}=n.data;n.data.postmate!=="call"?((p,v,D)=>{const z=typeof p[v]=="function"?p[v].apply(null,D):p[v];return Promise.resolve(z)})(this.model,r,d).then(p=>{n.source.postMessage({property:r,postmate:"reply",type:rt,uid:s,value:p},n.origin)}):r in this.model&&typeof this.model[r]=="function"&&this.model[r](l)})}emit(e,n){this.parent.postMessage({postmate:"emit",type:rt,value:{name:e,data:n}},this.parentOrigin)}}class nr{constructor(e){ne(this,"container",void 0),ne(this,"parent",void 0),ne(this,"frame",void 0),ne(this,"child",void 0),ne(this,"childOrigin",void 0),ne(this,"url",void 0),ne(this,"model",void 0),this.container=e.container,this.url=e.url,this.parent=window,this.frame=document.createElement("iframe"),e.id&&(this.frame.id=e.id),e.name&&(this.frame.name=e.name),this.frame.classList.add.apply(this.frame.classList,e.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=e.model||{}}sendHandshake(e){const n=(l=>{const d=document.createElement("a");d.href=l;const p=d.protocol.length>4?d.protocol:window.location.protocol,v=d.host.length?d.port==="80"||d.port==="443"?d.hostname:d.host:window.location.host;return d.origin||`${p}//${v}`})(e=e||this.url);let r,s=0;return new Promise((l,d)=>{const p=D=>!!tr(D,n)&&(D.data.postmate==="handshake-reply"?(clearInterval(r),this.parent.removeEventListener("message",p,!1),this.childOrigin=D.origin,l(new Co(this))):d("Failed handshake"));this.parent.addEventListener("message",p,!1);const v=()=>{s++,this.child.postMessage({postmate:"handshake",type:rt,model:this.model},n),s===5&&clearInterval(r)};this.frame.addEventListener("load",()=>{v(),r=setInterval(v,500)}),this.frame.src=e})}destroy(){this.frame.parentNode.removeChild(this.frame)}}ne(nr,"debug",!1),ne(nr,"Model",void 0);class Ao{constructor(e){ne(this,"child",void 0),ne(this,"model",void 0),ne(this,"parent",void 0),ne(this,"parentOrigin",void 0),this.child=window,this.model=e,this.parent=this.child.parent}sendHandshakeReply(){return new Promise((e,n)=>{const r=s=>{if(s.data.postmate){if(s.data.postmate==="handshake"){this.child.removeEventListener("message",r,!1),s.source.postMessage({postmate:"handshake-reply",type:rt},s.origin),this.parentOrigin=s.origin;const l=s.data.model;return l&&Object.keys(l).forEach(d=>{this.model[d]=l[d]}),e(new ko(this))}return n("Handshake Reply Failed")}};this.child.addEventListener("message",r,!1)})}}function ln(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const{importHTML:So,createSandboxContainer:Lo}=window.QSandbox||{};function jo(t,e){return t.startsWith("http")?fetch(t,e):(t=t.replace("file://",""),new Promise(async(n,r)=>{try{const s=await window.apis.doAction(["readFile",t]);n({text:()=>s})}catch(s){console.error(s),r(s)}}))}class Eo extends xt(){constructor(e){super(),ln(this,"_pluginLocal",void 0),ln(this,"_frame",void 0),ln(this,"_root",void 0),ln(this,"_loaded",!1),ln(this,"_unmountFns",[]),this._pluginLocal=e,e._dispose(()=>{this._unmount()})}async load(){const{name:e,entry:n}=this._pluginLocal.options;if(this.loaded||!n)return;const{template:r,execScripts:s}=await So(n,{fetch:jo});this._mount(r,document.body);const l=Lo(e,{elementGetter:()=>{var p;return(p=this._root)===null||p===void 0?void 0:p.firstChild}}).instance.proxy;l.__shadow_mode__=!0,l.LSPluginLocal=this._pluginLocal,l.LSPluginShadow=this,l.LSPluginUser=l.logseq=new pr(this._pluginLocal.toJSON(),this._pluginLocal.caller);const d=await s(l,!0);this._unmountFns.push(d.unmount),this._loaded=!0}_mount(e,n){const r=this._frame=document.createElement("div");r.classList.add("lsp-shadow-sandbox"),r.id=this._pluginLocal.id,this._root=r.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${e}</div>`,n.appendChild(r),this.emit("mounted")}_unmount(){for(const e of this._unmountFns)e&&e.call(null)}destroy(){var e,n;(e=this.frame)===null||e===void 0||(n=e.parentNode)===null||n===void 0||n.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var e;return(e=this._root)===null||e===void 0?void 0:e.firstChild}get frame(){return this._frame}}function Ye(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const dt=qe()("LSPlugin:caller"),un="#await#response#",Oo="#lspmsg#",_r="#lspmsg#error#",Fn=t=>`#lspmsg#${t}`;class Io extends xt(){constructor(e){super(),Ye(this,"_pluginLocal",void 0),Ye(this,"_connected",!1),Ye(this,"_parent",void 0),Ye(this,"_child",void 0),Ye(this,"_shadow",void 0),Ye(this,"_status",void 0),Ye(this,"_userModel",{}),Ye(this,"_call",void 0),Ye(this,"_callUserModel",void 0),Ye(this,"_debugTag",""),this._pluginLocal=e,e&&(this._debugTag=e.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:e}=this._pluginLocal;e?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(e={}){if(this._connected)return;const n=this,r=this._pluginLocal!=null;let s=0;const l=new Map,d=xe(6e4),p=this._extendUserModel({"#lspmsg#ready#":async z=>{p[Fn(z?.pid)]=({type:U,payload:W})=>{dt(`[host (_call) -> *user] ${this._debugTag}`,U,W),n.emit(U,W)},await d.resolve()},"#lspmsg#beforeunload#":async z=>{const U=xe(1e4);n.emit("beforeunload",Object.assign({actor:U},z)),await U.promise},"#lspmsg#settings#":async({type:z,payload:U})=>{n.emit("settings:changed",U)},[Oo]:async({ns:z,type:U,payload:W})=>{dt(`[host (async) -> *user] ${this._debugTag} ns=${z} type=${U}`,W),z&&z.startsWith("hook")?n.emit(`${z}:${U}`,W):n.emit(U,W)},"#lspmsg#reply#":({_sync:z,result:U})=>{if(dt(`[sync host -> *user] #${z}`,U),l.has(z)){const W=l.get(z);W&&(U!=null&&U.hasOwnProperty(_r)?W.reject(U[_r]):W.resolve(U),l.delete(z))}},...e});var v;if(r)return await d.promise,JSON.parse(JSON.stringify((v=this._pluginLocal)===null||v===void 0?void 0:v.toJSON()));const D=new Ao(p).sendHandshakeReply();return this._status="pending",await D.then(z=>{this._child=z,this._connected=!0,this._call=async(U,W={},ee)=>{if(ee){const J=++s;l.set(J,ee),W._sync=J,ee.setTag(`async call #${J}`),dt(`async call #${J}`)}return z.emit(Fn(p.baseInfo.id),{type:U,payload:W}),ee?.promise},this._callUserModel=async(U,W)=>{try{p[U](W)}catch{dt(`[model method] #${U} not existed`)}},setInterval(()=>{if(l.size>100)for(const[U,W]of l)W.settled&&l.delete(U)},18e5)}).finally(()=>{this._status=void 0}),await d.promise,p.baseInfo}async call(e,n={}){var r;return(r=this._call)===null||r===void 0?void 0:r.call(this,e,n)}async callAsync(e,n={}){var r;const s=xe(1e4);return(r=this._call)===null||r===void 0?void 0:r.call(this,e,n,s)}async callUserModel(e,...n){var r;return(r=this._callUserModel)===null||r===void 0?void 0:r.apply(this,[e,...n])}async callUserModelAsync(e,...n){var r;return e=`${un}${e}`,(r=this._callUserModel)===null||r===void 0?void 0:r.apply(this,[e,...n])}async _setupIframeSandbox(){const e=this._pluginLocal,n=e.id,r=`${n}_lsp_main`,s=new URL(e.options.entry);s.searchParams.set("__v__",e.options.version);const l=document.querySelector(`#${r}`);l&&l.parentElement.removeChild(l);const d=document.createElement("div");d.classList.add("lsp-iframe-sandbox-container"),d.id=r,d.dataset.pid=n;try{var p;const U=(p=await this._pluginLocal._loadLayoutsData())===null||p===void 0?void 0:p.$$0;if(U){d.dataset.inited_layout="true";let{width:W,height:ee,left:J,top:ae,vw:me,vh:Ie}=U;J=Math.max(J,0),J=typeof me=="number"?`${Math.min(100*J/me,99)}%`:`${J}px`,ae=Math.max(ae,45),ae=typeof Ie=="number"?`${Math.min(100*ae/Ie,99)}%`:`${ae}px`,Object.assign(d.style,{width:W+"px",height:ee+"px",left:J,top:ae})}}catch(U){console.error("[Restore Layout Error]",U)}document.body.appendChild(d);const v=new nr({id:n+"_iframe",container:d,url:s.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(e.toJSON()))}});let D,z=v.sendHandshake();return this._status="pending",new Promise((U,W)=>{D=setTimeout(()=>{W(new Error("handshake Timeout")),v.destroy()},4e3),z.then(ee=>{this._parent=ee,this._connected=!0,this.emit("connected"),ee.on(Fn(e.id),({type:J,payload:ae})=>{var me,Ie;dt("[user -> *host] ",J,ae),(me=this._pluginLocal)===null||me===void 0||me.emit(J,ae||{}),(Ie=this._pluginLocal)===null||Ie===void 0||Ie.caller.emit(J,ae||{})}),this._call=async(...J)=>{await ee.call(Fn(e.id),{type:J[0],payload:Object.assign(J[1]||{},{$$pid:e.id})})},this._callUserModel=async(J,...ae)=>{if(J.startsWith(un))return await ee.get(J.replace(un,""),...ae);ee.call(J,ae?.[0])},U(null)}).catch(ee=>{W(ee)}).finally(()=>{clearTimeout(D)})}).catch(U=>{throw dt("[iframe sandbox] error",U),U}).finally(()=>{this._status=void 0})}async _setupShadowSandbox(){const e=this._pluginLocal,n=this._shadow=new Eo(e);try{this._status="pending",await n.load(),this._connected=!0,this.emit("connected"),this._call=async(r,s={},l)=>{var d;return l&&(s.actor=l),(d=this._pluginLocal)===null||d===void 0||d.emit(r,Object.assign(s,{$$pid:e.id})),l?.promise},this._callUserModel=async(...r)=>{var s;let l=r[0];(s=l)!==null&&s!==void 0&&s.startsWith(un)&&(l=l.replace(un,""));const d=r[1]||{},p=this._userModel[l];typeof p=="function"&&await p.call(null,d)}}catch(r){throw dt("[shadow sandbox] error",r),r}finally{this._status=void 0}}_extendUserModel(e){return Object.assign(this._userModel,e)}_getSandboxIframeContainer(){var e;return(e=this._parent)===null||e===void 0?void 0:e.frame.parentNode}_getSandboxShadowContainer(){var e;return(e=this._shadow)===null||e===void 0?void 0:e.frame.parentNode}_getSandboxIframeRoot(){var e;return(e=this._parent)===null||e===void 0?void 0:e.frame}_getSandboxShadowRoot(){var e;return(e=this._shadow)===null||e===void 0?void 0:e.frame}set debugTag(e){this._debugTag=e}async destroy(){var e;let n=null;this._parent&&(n=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(n=this._getSandboxShadowContainer(),this._shadow.destroy()),(e=n)===null||e===void 0||e.parentNode.removeChild(n)}}function xr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Cr{constructor(e,n){xr(this,"ctx",void 0),xr(this,"opts",void 0),this.ctx=e,this.opts=n}get ctxId(){return this.ctx.baseInfo.id}setItem(e,n){var r;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,e,n,(r=this.opts)===null||r===void 0?void 0:r.assets]})}getItem(e){var n;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,e,(n=this.opts)===null||n===void 0?void 0:n.assets]})}removeItem(e){var n;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,e,(n=this.opts)===null||n===void 0?void 0:n.assets]})}allKeys(){var e;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,(e=this.opts)===null||e===void 0?void 0:e.assets]})}clear(){var e;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,(e=this.opts)===null||e===void 0?void 0:e.assets]})}hasItem(e){var n;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,e,(n=this.opts)===null||n===void 0?void 0:n.assets]})}}class To{constructor(e){var n,r,s;s=void 0,(r="ctx")in(n=this)?Object.defineProperty(n,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[r]=s,this.ctx=e}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(e,...n){var r,s;const l=this.ensureHostScope();return e=(r=I(e))===null||r===void 0?void 0:r.toLowerCase(),(s=l.logseq.api["exper_"+e])===null||s===void 0?void 0:s.apply(l,n)}async loadScripts(...e){(e=e.map(n=>n!=null&&n.startsWith("http")?n:this.ctx.resolveResourceFullUrl(n))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...e)}registerFencedCodeRenderer(e,n){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,e,n)}registerExtensionsEnhancer(e,n){const r=this.ensureHostScope();return e==="katex"&&r.katex&&n(r.katex).catch(console.error),r.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,e,n)}ensureHostScope(){if(window===top)throw new Error("Can not access host scope!");return top}}function Mt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const kr=t=>`task_callback_${t}`;class Po{constructor(e,n,r={}){Mt(this,"_client",void 0),Mt(this,"_requestId",void 0),Mt(this,"_requestOptions",void 0),Mt(this,"_promise",void 0),Mt(this,"_aborted",!1),this._client=e,this._requestId=n,this._requestOptions=r,this._promise=new Promise((p,v)=>{if(!this._requestId)return v(null);this._client.once(kr(this._requestId),D=>{D&&D instanceof Error?v(D):p(D)})});const{success:s,fail:l,final:d}=this._requestOptions;this._promise.then(p=>{s?.(p)}).catch(p=>{l?.(p)}).finally(()=>{d?.()})}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class rr extends an.EventEmitter{constructor(e){super(),Mt(this,"_ctx",void 0),this._ctx=e,this.ctx.caller.on("#lsp#request#callback",n=>{const r=n?.requestId;r&&this.emit(kr(r),n?.payload)})}static createRequestTask(e,n,r){return new Po(e,n,r)}async _request(e){const n=this.ctx.baseInfo.id,{success:r,fail:s,final:l,...d}=e,p=this.ctx.Experiments.invokeExperMethod("request",n,d),v=rr.createRequestTask(this.ctx.Request,p,e);return d.abortable?v:v.promise}get ctx(){return this._ctx}}const Fo=_n(Object.keys,Object);var Mo=Object.prototype.hasOwnProperty;const No=function(t){if(!qt(t))return Fo(t);var e=[];for(var n in Object(t))Mo.call(t,n)&&n!="constructor"&&e.push(n);return e},or=function(t){return vt(t)?It(t):No(t)},Ro=function(t,e){return t&&mn(t,e,or)},Do=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},zo=function(t){return this.__data__.has(t)};function Mn(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Ne;++e<n;)this.add(t[e])}Mn.prototype.add=Mn.prototype.push=Do,Mn.prototype.has=zo;const Uo=Mn,qo=function(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1},Ho=function(t,e){return t.has(e)},Ar=function(t,e,n,r,s,l){var d=1&n,p=t.length,v=e.length;if(p!=v&&!(d&&v>p))return!1;var D=l.get(t),z=l.get(e);if(D&&z)return D==e&&z==t;var U=-1,W=!0,ee=2&n?new Uo:void 0;for(l.set(t,e),l.set(e,t);++U<p;){var J=t[U],ae=e[U];if(r)var me=d?r(ae,J,U,e,t,l):r(J,ae,U,t,e,l);if(me!==void 0){if(me)continue;W=!1;break}if(ee){if(!qo(e,function(Ie,Je){if(!Ho(ee,Je)&&(J===Ie||s(J,Ie,n,r,l)))return ee.push(Je)})){W=!1;break}}else if(J!==ae&&!s(J,ae,n,r,l)){W=!1;break}}return l.delete(t),l.delete(e),W},Bo=function(t){var e=-1,n=Array(t.size);return t.forEach(function(r,s){n[++e]=[s,r]}),n},$o=function(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n};var Sr=f?f.prototype:void 0,ir=Sr?Sr.valueOf:void 0;const Go=function(t,e,n,r,s,l,d){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!l(new st(t),new st(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return L(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var p=Bo;case"[object Set]":var v=1&r;if(p||(p=$o),t.size!=e.size&&!v)return!1;var D=d.get(t);if(D)return D==e;r|=2,d.set(t,e);var z=Ar(p(t),p(e),r,s,l,d);return d.delete(t),z;case"[object Symbol]":if(ir)return ir.call(t)==ir.call(e)}return!1},Zo=function(t,e){for(var n=-1,r=e.length,s=t.length;++n<r;)t[s+n]=e[n];return t},Vo=function(t,e,n){var r=e(t);return Pe(t)?r:Zo(r,n(t))},Wo=function(t,e){for(var n=-1,r=t==null?0:t.length,s=0,l=[];++n<r;){var d=t[n];e(d,n,t)&&(l[s++]=d)}return l},Yo=function(){return[]};var Jo=Object.prototype.propertyIsEnumerable,Lr=Object.getOwnPropertySymbols;const Qo=Lr?function(t){return t==null?[]:(t=Object(t),Wo(Lr(t),function(e){return Jo.call(t,e)}))}:Yo,jr=function(t){return Vo(t,or,Qo)};var Xo=Object.prototype.hasOwnProperty;const Ko=function(t,e,n,r,s,l){var d=1&n,p=jr(t),v=p.length;if(v!=jr(e).length&&!d)return!1;for(var D=v;D--;){var z=p[D];if(!(d?z in e:Xo.call(e,z)))return!1}var U=l.get(t),W=l.get(e);if(U&&W)return U==e&&W==t;var ee=!0;l.set(t,e),l.set(e,t);for(var J=d;++D<v;){var ae=t[z=p[D]],me=e[z];if(r)var Ie=d?r(me,ae,z,e,t,l):r(ae,me,z,t,e,l);if(!(Ie===void 0?ae===me||s(ae,me,n,r,l):Ie)){ee=!1;break}J||(J=z=="constructor")}if(ee&&!J){var Je=t.constructor,zn=e.constructor;Je==zn||!("constructor"in t)||!("constructor"in e)||typeof Je=="function"&&Je instanceof Je&&typeof zn=="function"&&zn instanceof zn||(ee=!1)}return l.delete(t),l.delete(e),ee},sr=Ee(c,"DataView"),ar=Ee(c,"Promise"),cr=Ee(c,"Set"),lr=Ee(c,"WeakMap");var Er="[object Map]",Or="[object Promise]",Ir="[object Set]",Tr="[object WeakMap]",Pr="[object DataView]",ei=K(sr),ti=K(Te),ni=K(ar),ri=K(cr),oi=K(lr),kt=he;(sr&&kt(new sr(new ArrayBuffer(1)))!=Pr||Te&&kt(new Te)!=Er||ar&&kt(ar.resolve())!=Or||cr&&kt(new cr)!=Ir||lr&&kt(new lr)!=Tr)&&(kt=function(t){var e=he(t),n=e=="[object Object]"?t.constructor:void 0,r=n?K(n):"";if(r)switch(r){case ei:return Pr;case ti:return Er;case ni:return Or;case ri:return Ir;case oi:return Tr}return e});const Fr=kt;var Mr="[object Arguments]",Nr="[object Array]",Nn="[object Object]",Rr=Object.prototype.hasOwnProperty;const ii=function(t,e,n,r,s,l){var d=Pe(t),p=Pe(e),v=d?Nr:Fr(t),D=p?Nr:Fr(e),z=(v=v==Mr?Nn:v)==Nn,U=(D=D==Mr?Nn:D)==Nn,W=v==D;if(W&&ue(t)){if(!ue(e))return!1;d=!0,z=!1}if(W&&!z)return l||(l=new et),d||nt(t)?Ar(t,e,n,r,s,l):Go(t,e,v,n,r,s,l);if(!(1&n)){var ee=z&&Rr.call(t,"__wrapped__"),J=U&&Rr.call(e,"__wrapped__");if(ee||J){var ae=ee?t.value():t,me=J?e.value():e;return l||(l=new et),s(ae,me,n,r,l)}}return!!W&&(l||(l=new et),Ko(t,e,n,r,s,l))},Dr=function t(e,n,r,s,l){return e===n||(e==null||n==null||!_e(e)&&!_e(n)?e!=e&&n!=n:ii(e,n,r,s,t,l))},si=function(t,e,n,r){var s=n.length,l=s,d=!r;if(t==null)return!l;for(t=Object(t);s--;){var p=n[s];if(d&&p[2]?p[1]!==t[p[0]]:!(p[0]in t))return!1}for(;++s<l;){var v=(p=n[s])[0],D=t[v],z=p[1];if(d&&p[2]){if(D===void 0&&!(v in t))return!1}else{var U=new et;if(r)var W=r(D,z,v,t,e,U);if(!(W===void 0?Dr(z,D,3,r,U):W))return!1}}return!0},zr=function(t){return t==t&&!Fe(t)},ai=function(t){for(var e=or(t),n=e.length;n--;){var r=e[n],s=t[r];e[n]=[r,s,zr(s)]}return e},Ur=function(t,e){return function(n){return n!=null&&n[t]===e&&(e!==void 0||t in Object(n))}},ci=function(t){var e=ai(t);return e.length==1&&e[0][2]?Ur(e[0][0],e[0][1]):function(n){return n===t||si(n,t,e)}},ur=function(t){return typeof t=="symbol"||_e(t)&&he(t)=="[object Symbol]"};var li=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ui=/^\w*$/;const fr=function(t,e){if(Pe(t))return!1;var n=typeof t;return!(n!="number"&&n!="symbol"&&n!="boolean"&&t!=null&&!ur(t))||ui.test(t)||!li.test(t)||e!=null&&t in Object(e)};function dr(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var n=function(){var r=arguments,s=e?e.apply(this,r):r[0],l=n.cache;if(l.has(s))return l.get(s);var d=t.apply(this,r);return n.cache=l.set(s,d)||l,d};return n.cache=new(dr.Cache||Ne),n}dr.Cache=Ne;const fi=dr;var di=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pi=/\\(\\)?/g;const hi=function(t){var e=fi(t,function(r){return n.size===500&&n.clear(),r}),n=e.cache;return e}(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(di,function(n,r,s,l){e.push(s?l.replace(pi,"$1"):r||n)}),e}),gi=function(t,e){for(var n=-1,r=t==null?0:t.length,s=Array(r);++n<r;)s[n]=e(t[n],n,t);return s};var qr=f?f.prototype:void 0,Hr=qr?qr.toString:void 0;const mi=function t(e){if(typeof e=="string")return e;if(Pe(e))return gi(e,t)+"";if(ur(e))return Hr?Hr.call(e):"";var n=e+"";return n=="0"&&1/e==-1/0?"-0":n},yi=function(t){return t==null?"":mi(t)},Br=function(t,e){return Pe(t)?t:fr(t,e)?[t]:hi(yi(t))},Rn=function(t){if(typeof t=="string"||ur(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e},$r=function(t,e){for(var n=0,r=(e=Br(e,t)).length;t!=null&&n<r;)t=t[Rn(e[n++])];return n&&n==r?t:void 0},vi=function(t,e,n){var r=t==null?void 0:$r(t,e);return r===void 0?n:r},bi=function(t,e){return t!=null&&e in Object(t)},wi=function(t,e,n){for(var r=-1,s=(e=Br(e,t)).length,l=!1;++r<s;){var d=Rn(e[r]);if(!(l=t!=null&&n(t,d)))break;t=t[d]}return l||++r!=s?l:!!(s=t==null?0:t.length)&&$t(s)&&Ot(d,s)&&(Pe(t)||jt(t))},_i=function(t,e){return t!=null&&wi(t,e,bi)},xi=function(t,e){return fr(t)&&zr(e)?Ur(Rn(t),e):function(n){var r=vi(n,t);return r===void 0&&r===e?_i(n,t):Dr(e,r,3)}},Ci=function(t){return function(e){return e?.[t]}},ki=function(t){return function(e){return $r(e,t)}},Ai=function(t){return fr(t)?Ci(Rn(t)):ki(t)},Si=function(t){return typeof t=="function"?t:t==null?Pt:typeof t=="object"?Pe(t)?xi(t[0],t[1]):ci(t):Ai(t)},Li=function(t,e){var n={};return e=Si(e),Ro(t,function(r,s,l){Lt(n,e(r,s,l),r)}),n};function Gr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class ji{constructor(e,n){Gr(this,"ctx",void 0),Gr(this,"serviceHooks",void 0),this.ctx=e,this.serviceHooks=n,e._execCallableAPI("register-search-service",e.baseInfo.id,n.name,n.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:r=>(Pe(r?.blocks)&&(r.blocks=r.blocks.map(s=>s&&Li(s,(l,d)=>`block/${d}`))),r)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach(([r,s])=>{const l=(d=>`service:search:${d}:${n.name}`)(r);e.caller.on(l,async d=>{if(m(n?.[s.f])){let p=null;try{p=await n[s.f].apply(n,(s.args||[]).map(v=>{if(d){if(v===!0)return d;if(d.hasOwnProperty(v)){const D=d[v];return delete d[v],D}}})),s.transformOutput&&(p=s.transformOutput(p))}catch(v){console.error("[SearchService] ",v),p=v}finally{s.reply&&e.caller.call(`${l}:reply`,p)}}})})}}function He(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const Ei=Symbol.for("proxy-continue"),Oi=qe()("LSPlugin:user"),Zr=new se("",{console:!0});function Nt(t,e,n){var r;if(typeof n!="function")return!1;const{key:s,label:l,desc:d,palette:p,keybinding:v,extras:D}=e,z=`SimpleCommandHook${s}${++Yr}`;this.Editor["on"+z](n),(r=this.caller)===null||r===void 0||r.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:s,label:l,type:t,desc:d,keybinding:v,extras:D},["editor/hook",z]],p]})}function Vr(t){return!(typeof(e=t)!="string"||e.length!==36||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(e))||(Zr.error(`#${t} is not a valid UUID string.`),!1);var e}let Dn=null,Wr=new Map;const Ii={async getInfo(t){return Dn||(Dn=await this._execCallableAPIAsync("get-app-info")),typeof t=="string"?Dn[t]:Dn},registerCommand:Nt,registerSearchService(t){if(Wr.has(t.name))throw new Error(`SearchService: #${t.name} has registered!`);Wr.set(t.name,new ji(this,t))},registerCommandPalette(t,e){const{key:n,label:r,keybinding:s}=t;return Nt.call(this,"$palette$",{key:n,label:r,palette:!0,keybinding:s},e)},registerCommandShortcut(t,e){const{binding:n}=t,r="$shortcut$",s=r+I(n);return Nt.call(this,r,{key:s,palette:!1,keybinding:t},e)},registerUIItem(t,e){var n;const r=this.baseInfo.id;(n=this.caller)===null||n===void 0||n.call("api:call",{method:"register-plugin-ui-item",args:[r,t,e]})},registerPageMenuItem(t,e){if(typeof e!="function")return!1;const n=t+"_"+this.baseInfo.id,r=t;Nt.call(this,"page-menu-item",{key:n,label:r},e)},onBlockRendererSlotted(t,e){if(!Vr(t))return;const n=this.baseInfo.id,r=`hook:editor:${I(`slot:${t}`)}`;return this.caller.on(r,e),this.App._installPluginHook(n,r),()=>{this.caller.off(r,e),this.App._uninstallPluginHook(n,r)}},invokeExternalPlugin(t,...e){var n;if(!(t=(n=t)===null||n===void 0?void 0:n.trim()))return;let[r,s]=t.split(".");if(!["models","commands"].includes(s?.toLowerCase()))throw new Error("Type only support '.models' or '.commands' currently.");const l=t.replace(`${r}.${s}.`,"");if(!r||!s||!l)throw new Error(`Illegal type of #${t} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",r,s.toLowerCase(),l,e)},setFullScreen(t){const e=(...n)=>this._callWin("setFullScreen",...n);t==="toggle"?this._callWin("isFullScreen").then(n=>{n?e():e(!0)}):t?e(!0):e()}};let Yr=0;const Ti={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(t,e){var n;Oi("Register slash command #",this.baseInfo.id,t,e),typeof e=="function"&&(e=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",e]]),e=e.map(r=>{const[s,...l]=r;if(s==="editor/hook"){let d=l[0],p=()=>{var D;(D=this.caller)===null||D===void 0||D.callUserModel(d)};typeof d=="function"&&(p=d);const v=`SlashCommandHook${s}${++Yr}`;r[1]=v,this.Editor["on"+v](p)}return r}),(n=this.caller)===null||n===void 0||n.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[t,e]]})},registerBlockContextMenuItem(t,e){if(typeof e!="function")return!1;const n=t+"_"+this.baseInfo.id;Nt.call(this,"block-context-menu-item",{key:n,label:t},e)},registerHighlightContextMenuItem(t,e,n){if(typeof e!="function")return!1;const r=t+"_"+this.baseInfo.id;Nt.call(this,"highlight-context-menu-item",{key:r,label:t,extras:n},e)},scrollToBlockInPage(t,e,n){const r="block-content-"+e;n!=null&&n.replaceState?this.App.replaceState("page",{name:t},{anchor:r}):this.App.pushState("page",{name:t},{anchor:r})}},Pi={onBlockChanged(t,e){if(!Vr(t))return;const n=this.baseInfo.id,r=`hook:db:${I(`block:${t}`)}`,s=({block:l,txData:d,txMeta:p})=>{l.uuid===t&&e(l,d,p)};return this.caller.on(r,s),this.App._installPluginHook(n,r),()=>{this.caller.off(r,s),this.App._uninstallPluginHook(n,r)}},datascriptQuery(t,...e){return e.pop(),e!=null&&e.some(n=>typeof n=="function")?this.Experiments.ensureHostScope().logseq.api.datascript_query(t,...e):this._execCallableAPIAsync("datascript_query",t,...e)}},Fi={},Mi={},Ni={makeSandboxStorage(){return new Cr(this,{assets:!0})}};class pr extends xt(){constructor(e,n){super(),He(this,"_baseInfo",void 0),He(this,"_caller",void 0),He(this,"_version","0.0.14"),He(this,"_debugTag",""),He(this,"_settingsSchema",void 0),He(this,"_connected",!1),He(this,"_ui",new Map),He(this,"_mFileStorage",void 0),He(this,"_mRequest",void 0),He(this,"_mExperiments",void 0),He(this,"_beforeunloadCallback",void 0),this._baseInfo=e,this._caller=n,n.on("sys:ui:visible",r=>{r!=null&&r.toggle&&this.toggleMainUI()}),n.on("settings:changed",r=>{const s=Object.assign({},this.settings),l=Object.assign(this._baseInfo.settings,r);this.emit("settings:changed",{...l},s)}),n.on("beforeunload",async r=>{const{actor:s,...l}=r,d=this._beforeunloadCallback;try{d&&await d(l),s?.resolve(null)}catch(p){console.debug(`${n.debugTag} [beforeunload] `,p),s?.reject(p)}})}async ready(e,n){if(!this._connected)try{var r;typeof e=="function"&&(n=e,e={});let s=await this._caller.connectToParent(e);this._connected=!0,s=j(this._baseInfo,s),(r=s)!==null&&r!==void 0&&r.id&&(this._debugTag=this._caller.debugTag=`#${s.id} [${s.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(s.settings=function(l,d){const p=(d||[]).reduce((v,D)=>("default"in D&&(v[D.key]=D.default),v),{});return Object.assign(p,l)}(s.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(l){console.warn(l)}n&&n.call(this,s)}catch(s){console.error(`${this._debugTag} [Ready Error]`,s)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(e){typeof e=="function"&&(this._beforeunloadCallback=e)}provideModel(e){return this.caller._extendUserModel(e),this}provideTheme(e){return this.caller.call("provider:theme",e),this}provideStyle(e){return this.caller.call("provider:style",e),this}provideUI(e){return this.caller.call("provider:ui",e),this}useSettingsSchema(e){return this.connected&&this.caller.call("settings:schema",{schema:e,isSync:!0}),this._settingsSchema=e,this}updateSettings(e){this.caller.call("settings:update",e)}onSettingsChanged(e){const n="settings:changed";return this.on(n,e),()=>this.off(n,e)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(e){this.caller.call("main-ui:attrs",e)}setMainUIInlineStyle(e){this.caller.call("main-ui:style",e)}hideMainUI(e){const n={key:0,visible:!1,cursor:e?.restoreEditingCursor};this.caller.call("main-ui:visible",n),this.emit("ui:visible:changed",n),this._ui.set(n.key,n)}showMainUI(e){const n={key:0,visible:!0,autoFocus:e?.autoFocus};this.caller.call("main-ui:visible",n),this.emit("ui:visible:changed",n),this._ui.set(n.key,n)}toggleMainUI(){const n=this._ui.get(0);n&&n.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){const e=this._ui.get(0);return Boolean(e&&e.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){return(e=this)&&(((n=e.baseInfo)===null||n===void 0?void 0:n.effect)||!((r=e.baseInfo)!==null&&r!==void 0&&r.iir));var e,n,r}get logger(){return Zr}get settings(){var e;return(e=this.baseInfo)===null||e===void 0?void 0:e.settings}get caller(){return this._caller}resolveResourceFullUrl(e){if(this.ensureConnected(),e)return e=e.replace(/^[.\\/]+/,""),pe(this._baseInfo.lsr,e)}_makeUserProxy(e,n){const r=this,s=this.caller;return new Proxy(e,{get(l,d,p){const v=l[d];return function(...D){if(v){const U=v.apply(r,D.concat(n));if(U!==Ei)return U}if(n){const U=d.toString().match(/^(once|off|on)/i);if(U!=null){const W=U[0].toLowerCase(),ee=U.input.slice(W.length),J=W==="off",ae=r.baseInfo.id,me=`hook:${n}:${I(ee)}`,Ie=D[0];s[W](me,Ie);const Je=()=>{s.off(me,Ie),s.listenerCount(me)||r.App._uninstallPluginHook(ae,me)};return J?void Je():(r.App._installPluginHook(ae,me),Je)}}let z=d;return["git","ui","assets"].includes(n)&&(z=n+"_"+z),s.callAsync("api:call",{tag:n,method:z,args:D})}}})}_execCallableAPIAsync(e,...n){return this._caller.callAsync("api:call",{method:e,args:n})}_execCallableAPI(e,...n){this._caller.call("api:call",{method:e,args:n})}_callWin(...e){return this._execCallableAPIAsync("_callMainWin",...e)}get App(){return this._makeUserProxy(Ii,"app")}get Editor(){return this._makeUserProxy(Ti,"editor")}get DB(){return this._makeUserProxy(Pi,"db")}get Git(){return this._makeUserProxy(Fi,"git")}get UI(){return this._makeUserProxy(Mi,"ui")}get Assets(){return this._makeUserProxy(Ni,"assets")}get FileStorage(){let e=this._mFileStorage;return e||(e=this._mFileStorage=new Cr(this)),e}get Request(){let e=this._mRequest;return e||(e=this._mRequest=new rr(this)),e}get Experiments(){let e=this._mExperiments;return e||(e=this._mExperiments=new To(this)),e}}function Jr(t,e){return new pr(t,e)}if(window.__LSP__HOST__==null){const t=new Io(null);window.logseq=Jr({},t)}})(),F})())})(Ri,gr);const Di={title:"Awesome Links",icon:"./icon.png",id:"logseq-awesome-links"},ye=parent.document,Qr=ye.documentElement,Qe=ye.body,N={pluginID:Di.id,pluginConfig:null,isPluginEnabled:"is-awLi-enabled",extLinksSelector:".external-link",pageLinksSelector:".page-ref:not(.page-property-key), .tag, .references li a",titleSelector:".page-title, .journal-title .title",sidebarLinkSelector:".nav-contents-container .page-title",tabLinkSelector:".logseq-tab:not(.close-all) .logseq-tab-title",tagHasBg:!1,themeColor:"",themeBg:"",favIconsCache:Object.create(null),defaultPageProps:Object.create(null),defaultJournalProps:Object.create(null)},zi=async o=>{o=o.toLowerCase();const a=`
    [
      :find ?isjournal
      :where
          [?id :block/name "${o}"]
          [?id :block/journal? ?isjournal]
    ]
    `,u=await logseq.DB.datascriptQuery(a);return!!(u[0]&&u[0][0])},hn=async o=>{const a=o;o=o.toLowerCase();let u=Object.create(null);const b=`
    [
      :find ?props
      :where
          [?id :block/name "${o}"]
          [?id :block/properties ?props]
    ]
    `;if(await zi(o))u=N.defaultJournalProps;else{const F=await logseq.DB.datascriptQuery(b);F[0]&&F[0][0]&&F[0][0].icon&&(u.icon=F[0][0].icon),F[0]&&F[0][0]&&F[0][0].color&&(u.color=F[0][0].color.replaceAll('"',"")),F[0]&&F[0][0]&&F[0][0].hidetitle&&(u.hidetitle=F[0][0].hidetitle,u.hidetitletext=a)}return u},ro=async(o,a)=>{o=o.toLowerCase();let u="";const b=`
    [
      :find ?title
      :where
          [?id :block/name "${o}"]
          [?id :block/properties ?prop]
          [(get ?prop :${a}) ?title]
    ]
    `,_=await logseq.DB.datascriptQuery(b);return _.length&&(u=_[0][0][0]),u},oo=async o=>{o=o.toLowerCase();let a="";const u=`
    [
        :find ?origtitle
        :where
            [?id :block/name "${o}"]
            [?origid :block/alias ?id]
            [?origid :block/name ?origtitle]
    ]
    `,b=await logseq.DB.datascriptQuery(u);return b.length&&(a=b[0][0]),a},io=async o=>{let a=Object.create(null),u=await hn(o);return u&&(a={...u}),(!a.icon||!a.color)&&(u=await qi(o),u&&(a={...u,...a}),(!a.icon||!a.color)&&N.pluginConfig.inheritFromProp&&(u=await so(o),u&&(a={...u,...a}),(!a.icon||!a.color)&&(u=await Hi(o),u&&(a={...u,...a}))),N.pluginConfig.inheritFromHierarchy&&o.includes("/")&&(!a.icon||!a.color)&&(u=await Ui(o),a={...u,...a})),a={...N.defaultPageProps,...a},a.__proto__=null,a},Ui=async o=>{let a=Object.create(null);o=o.split("/")[0],a=await hn(o);let u={...a};return(!a.icon||!a.color)&&(a=await so(o),u={...a,...u}),u},qi=async o=>{let a=Object.create(null);const u=await oo(o);return u&&(a=await hn(u)),a},so=async o=>{let a=Object.create(null);const u=await ro(o,N.pluginConfig.inheritFromProp);return u&&(a=await hn(u)),a},Hi=async o=>{let a=Object.create(null);const u=await oo(o);if(u){const b=await ro(u,N.pluginConfig.inheritFromProp);b&&(a=await hn(b))}return a};function Xr(o,a,u){return Math.min(Math.max(o,u),a)}class Bi extends Error{constructor(a){super(`Failed to parse color: "${a}"`)}}var dn=Bi;function $i(o){if(typeof o!="string")throw new dn(o);if(o.trim().toLowerCase()==="transparent")return[0,0,0,0];let a=o.trim();a=Xi.test(o)?Vi(o):o;const u=Wi.exec(a);if(u){const O=Array.from(u).slice(1);return[...O.slice(0,3).map(h=>parseInt(pn(h,2),16)),parseInt(pn(O[3]||"f",2),16)/255]}const b=Yi.exec(a);if(b){const O=Array.from(b).slice(1);return[...O.slice(0,3).map(h=>parseInt(h,16)),parseInt(O[3]||"ff",16)/255]}const _=Ji.exec(a);if(_){const O=Array.from(_).slice(1);return[...O.slice(0,3).map(h=>parseInt(h,10)),parseFloat(O[3]||"1")]}const F=Qi.exec(a);if(F){const[O,h,L,P]=Array.from(F).slice(1).map(parseFloat);if(Xr(0,100,h)!==h)throw new dn(o);if(Xr(0,100,L)!==L)throw new dn(o);return[...Ki(O,h,L),Number.isNaN(P)?1:P]}throw new dn(o)}function Gi(o){let a=5381,u=o.length;for(;u;)a=a*33^o.charCodeAt(--u);return(a>>>0)%2341}const Kr=o=>parseInt(o.replace(/_/g,""),36),Zi="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((o,a)=>{const u=Kr(a.substring(0,3)),b=Kr(a.substring(3)).toString(16);let _="";for(let F=0;F<6-b.length;F++)_+="0";return o[u]=`${_}${b}`,o},{});function Vi(o){const a=o.toLowerCase().trim(),u=Zi[Gi(a)];if(!u)throw new dn(o);return`#${u}`}const pn=(o,a)=>Array.from(Array(a)).map(()=>o).join(""),Wi=new RegExp(`^#${pn("([a-f0-9])",3)}([a-f0-9])?$`,"i"),Yi=new RegExp(`^#${pn("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),Ji=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${pn(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),Qi=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,Xi=/^[a-z]+$/i,eo=o=>Math.round(o*255),Ki=(o,a,u)=>{let b=u/100;if(a===0)return[b,b,b].map(eo);const _=(o%360+360)%360/60,F=(1-Math.abs(2*b-1))*(a/100),O=F*(1-Math.abs(_%2-1));let h=0,L=0,P=0;_>=0&&_<1?(h=F,L=O):_>=1&&_<2?(h=O,L=F):_>=2&&_<3?(L=F,P=O):_>=3&&_<4?(L=O,P=F):_>=4&&_<5?(h=O,P=F):_>=5&&_<6&&(h=F,P=O);const g=b-F/2,C=h+g,Z=L+g,x=P+g;return[C,Z,x].map(eo)};function to(o){if(o==="transparent")return 0;function a(F){const O=F/255;return O<=.03928?O/12.92:Math.pow((O+.055)/1.055,2.4)}const[u,b,_]=$i(o);return .2126*a(u)+.7152*a(b)+.0722*a(_)}function es(o,a){const u=to(o),b=to(a);return u>b?(u+.05)/(b+.05):(b+.05)/(u+.05)}const ts={decorative:1.5,readable:3,aa:4.5,aaa:7};function ns(o,a="aa",u="#fff"){return es(o,u)<ts[a]}const rs=(o,a)=>Object.keys(o).filter(b=>o[b]!==a[b]),os=async()=>{const o=await fetch(`https://api.github.com/repos/yoyurec/${N.pluginID}/releases/latest`,{headers:{Accept:"application/vnd.github.v3+json"}});if(!o.ok){const u=`An error has occured: ${o.status}`;throw new Error(u)}const a=await o.json();a&&a.tag_name.replace("v","").localeCompare(N.pluginVersion,void 0,{numeric:!0,sensitivity:"base"})==1&&logseq.UI.showMsg(`"${N.pluginID}" new version is available! Please, update!`,"warning",{timeout:3e4})},At=async o=>{let a;try{a=await fetch(o)}catch{return""}const u=await a.blob();return new Promise(b=>{const _=new FileReader;_.readAsDataURL(u),_.onloadend=()=>{const F=_.result;b(F)}})},ao=(o,a)=>!!ns(o,"decorative",a),qn=o=>{const a=Object.create(null),u=o.split(`
`),b=u.find(F=>F.includes("icon::"));if(b){const F=b.split("::");F&&(a.icon=F[1].trim())}const _=u.find(F=>F.includes("color::"));if(_){const F=_.split("::");F&&(a.color=F[1].trim())}return a},is=o=>/[\p{Extended_Pictographic}\u{1F3FB}-\u{1F3FF}\u{1F9B0}-\u{1F9B3}]/u.test(o),ss=(o,a,u)=>{const b=ye.getElementById(o);b&&(co(o,a),b.contentDocument?.head.insertAdjacentHTML("beforeend",`<style id='${a}'>
            ${u}
        </style>`))},co=(o,a)=>{const u=ye.getElementById(o);u&&u.contentDocument?.getElementById(a)?.remove()};const lo=async o=>{o||(o=[...ye.querySelectorAll(N.extLinksSelector)]);for(let a=0;a<o.length;a++){const u=o[a];as(u),N.pluginConfig.inheritExtColor&&uo(u)}},as=async o=>{const a=o.querySelector(".awLi-favicon");a&&a.remove();const u=o.href;let b={format:"img",src:""};const{hostname:_}=new URL(u);if(_?N.favIconsCache.has(_)?b=N.favIconsCache.get(_):(b=await no(u),N.favIconsCache.set(_,b)):b=await no(u),b.format==="img"){const F=ye.createElement("img");F.classList.add("awLi-favicon"),F.src=b.src,o.insertAdjacentElement("afterbegin",F);return}b.format==="svg"&&o.insertAdjacentHTML("afterbegin",b.src)},no=async o=>{let a={format:"img",src:""};const{hostname:u,protocol:b}=new URL(o);return b==="message:"||b==="mailto:"?a={format:"svg",src:'<svg class="awLi-favicon" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24"><path stroke="none" d="M0 0h24v24H0z"/><path d="M3 7a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><path d="m3 7 9 6 9-6"/></svg>'}:b==="tel:"?a={format:"svg",src:'<svg class="awLi-favicon" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24"><path stroke="none" d="M0 0h24v24H0z"/><path d="M5 4h4l2 5-2.5 1.5a11 11 0 0 0 5 5L15 13l5 2v4a2 2 0 0 1-2 2A16 16 0 0 1 3 6a2 2 0 0 1 2-2"/></svg>'}:b==="logseq:"?a={format:"svg",src:'<svg class="awLi-favicon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 80 80"><rect width="64" height="64" x="8" y="8" fill="#002B34" rx="12"/><path fill="#86C8C8" d="M18.6 18.3c-2 .6-3.2 1.7-4 3.5-2.5 5 1.7 11.8 7.7 12.5 2.4.3 4.1-.3 5.7-2 2.4-2.4 2.7-5.4 1-8.8-1.9-4-6.8-6.4-10.4-5.2ZM41 34.9c-3 .6-4.1 1-7 2.5-6 3-9.4 8.9-8.5 14.4.7 4 4 8.5 8.1 11a26.1 26.1 0 0 0 22 1.4c4.2-1.8 7.8-5 9.4-8.5 1.7-3.6 1.5-8-.6-11.7-1.2-2-4.6-5.2-7-6.5A27.2 27.2 0 0 0 41 34.9Z"/><ellipse cx="44.1" cy="22.1" fill="#86C8C8" rx="8.8" ry="5.5" transform="rotate(-15 44 22)"/></svg>'}:b==="zotero:"?a={format:"svg",src:'<svg class="awLi-favicon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 31"><path fill="#cc2936" d="M15.5 8.4 4 23.4h12V26H0v-2L11.5 8.9H.5V6.3h15Z"/></svg>'}:b==="file:"?a={format:"svg",src:'<svg class="awLi-favicon" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24"><path stroke="none" d="M0 0h24v24H0z"/><path d="M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2"/></svg>'}:u==="youtu.be"?a={format:"img",src:await At("https://t3.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://youtube.com&size=32")}:u==="gmail.com"||u==="mail.google.com"?a={format:"img",src:await At("https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico")}:o.includes("docs.google.com/document")?a={format:"img",src:await At("https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico")}:o.includes("docs.google.com/spreadsheets")?a={format:"img",src:await At("https://ssl.gstatic.com/docs/spreadsheets/favicon3.ico")}:o.includes("docs.google.com/presentation")?a={format:"img",src:await At("https://ssl.gstatic.com/docs/presentations/images/favicon5.ico")}:o.includes(".atlassian.net/jira/")||o.includes(".atlassian.net/browse/")?a={format:"svg",src:'<svg class="awLi-favicon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 80 80"><defs><linearGradient id="a" x1="38.1" x2="23.2" y1="18.5" y2="33.5" gradientUnits="userSpaceOnUse"><stop offset=".2" stop-color="#0052cc"/><stop offset="1" stop-color="#2684ff"/></linearGradient><linearGradient xlink:href="#a" id="b" x1="42.1" x2="57" y1="61.5" y2="46.5"/></defs><path d="M74.2 38 43 6.9l-3-3-23.4 23.4L5.9 38a2.9 2.9 0 0 0 0 4l21.4 21.5L40 76.3l23.5-23.5.3-.3L74.2 42a2.9 2.9 0 0 0 0-4.1ZM40 50.8 29.3 40 40 29.4 50.7 40Z" style="fill:#2684ff"/><path d="M40 29.4A18 18 0 0 1 40 4L16.5 27.4 29.3 40 40 29.4Z" style="fill:url(#a)"/><path d="M50.8 40 40 50.8a18 18 0 0 1 0 25.5l23.5-23.5Z" style="fill:url(#b)"/></svg>'}:((b==="http:"||b==="https:")&&(a={format:"img",src:await At(`https://t3.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://${u}&size=32`)},a.src==="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsSAAALEgHS3X78AAACiElEQVQ4EaVTzU8TURCf2tJuS7tQtlRb6UKBIkQwkRRSEzkQgyEc6lkOKgcOph78Y+CgjXjDs2i44FXY9AMTlQRUELZapVlouy3d7kKtb0Zr0MSLTvL2zb75eL838xtTvV6H/xELBptMJojeXLCXyobnyog4YhzXYvmCFi6qVSfaeRdXdrfaU1areV5KykmX06rcvzumjY/1ggkR3Jh+bNf1mr8v1D5bLuvR3qDgFbvbBJYIrE1mCIoCrKxsHuzK+Rzvsi29+6DEbTZz9unijEYI8ObBgXOzlcrx9OAlXyDYKUCzwwrDQx1wVDGg089Dt+gR3mxmhcUnaWeoxwMbm/vzDFzmDEKMMNhquRqduT1KwXiGt0vre6iSeAUHNDE0d26NBtAXY9BACQyjFusKuL2Ry+IPb/Y9ZglwuVscdHaknUChqLF/O4jn3V5dP4mhgRJgwSYm+gV0Oi3XrvYB30yvhGa7BS70eGFHPoTJyQHhMK+F0ZesRVVznvXw5Ixv7/C10moEo6OZXbWvlFAF9FVZDOqEABUMRIkMd8GnLwVWg9/RkJF9sA4oDfYQAuzzjqzwvnaRUFxn/X2ZlmGLXAE7AL52B4xHgqAUqrC1nSNuoJkQtLkdqReszz/9aRvq90NOKdOS1nch8TpL555WDp49f3uAMXhACRjD5j4ykuCtf5PP7Fm1b0DIsl/VHGezzP1KwOiZQobFF9YyjSRYQETRENSlVzI8iK9mWlzckpSSCQHVALmN9Az1euDho9Xo8vKGd2rqooA8yBcrwHgCqYR0kMkWci08t/R+W4ljDCanWTg9TJGwGNaNk3vYZ7VUdeKsYJGFNkfSzjXNrSX20s4/h6kB81/271ghG17l+rPTAAAAAElFTkSuQmCC"&&(a={format:"img",src:await At(`https://icons.duckduckgo.com/ip3/${u}`)},a.src==="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkI4OUQxMDdDQTYwMTFFNEJGMThCRkI4NTA4NTkyNkYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkI4OUQxMDhDQTYwMTFFNEJGMThCRkI4NTA4NTkyNkYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCQjg5RDEwNUNBNjAxMUU0QkYxOEJGQjg1MDg1OTI2RiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCQjg5RDEwNkNBNjAxMUU0QkYxOEJGQjg1MDg1OTI2RiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PjGq5lQAAAI0SURBVHja1Jo9jsIwEIW9Fh17gBxgD0B63EPPBXIBDkAP/Ub0XIAeeuiTA3CAHID061mNkWXlPzN28qQRQojkffZkPEn8dT6fBYFiHSv8jDCqVGBkOnL8HKXFSNNbHUrHsuN/DNwKv5c6HjpuQ2EWA40nlokxAvANBszIpS9IHwAYub2OteARDMivjqeOFFOtVbLjwRWODpd5W2s8l6ICgFE/9shzQZRaRzz3KICDjp0Ipx16GARwwIsrtDZNELIhbaZg3obYdwVQgdOmKZ1UG0DUlnOBdXBXeVmROssJAyzdVJLOCktV51867ozrRFy1EieE5mGU3tYFSK3EtBzS6SapzZ+YZsJ0vh+ALYN5wQyxtQEUEcC75jcOCGUAYqLKs2kpwdQQ4DmWRLkfCmIl7ZI0Q4j/GYh8N2CEEBEXgC+ISApesUNwA7BD+ABglQ+AO44yy52fnLN5A1DM1Tx45wLwYf4DkM3UPCgDgHym5kG5mYFyhuZLMwOgB8EBf3R8ezL/8WwAbkQAaQUE1xO+mw2QEV0LLgSX+dy9qQddiA5uIDifrV6qVmIgehJCcJl/2qXfbSVSoorEpRI91vZCRUspDK2T2znImvJ0naD5a1W5r+tGU8H3bHPoIpn2badPE4FoXOFlh5y7Bk6bxmuyy3viFMsW1HVf7w5KNN7a4nS9I4MDJYTrRFudT7r2Z33e1Bc4C5RbDdz2gHWrgb1iZ2LYZo+qVPG+2cMFESLgdps/AQYA9D2Sc4DqpGYAAAAASUVORK5CYII="&&(a={format:"svg",src:'<svg class="awLi-favicon" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24"><path stroke="none" d="M0 0h24v24H0z"/><path d="M3 12a9 9 0 1 0 18 0 9 9 0 1 0-18 0m.6-3h16.8M3.6 15h16.8"/><path d="M11.5 3a17 17 0 0 0 0 18m1-18a17 17 0 0 1 0 18"/></svg>'}))),a)},uo=async o=>{const a=o.closest(".ls-block[data-refs-self]");if(!a)return;const u=a.getAttribute("data-refs-self")||"",b=JSON.parse(u);if(!b.length)return;const _=b[0].toLowerCase();if(_){const F=await io(_);if(F){const O=F.color;O&&O!=="none"&&(o.style.setProperty("--awLi-color",O),o.classList.add("awLi-color"),N.pluginConfig.fixLowContrast&&ao(O,N.themeBg)&&o.classList.add("awLi-stroke"))}}},cs=()=>{const o=ye.querySelectorAll(".awLi-favicon");if(o.length)for(let a=0;a<o.length;a++)o[a].remove()},ls=()=>{const o=[...ye.querySelectorAll(N.extLinksSelector)];if(o.length)for(let a=0;a<o.length;a++)uo(o[a])},us=()=>{const o=[...ye.querySelectorAll(N.extLinksSelector)];if(o.length)for(let a=0;a<o.length;a++){const u=o[a];u.style.setProperty("--awLi-color",""),u.classList.remove("awLi-color","awLi-stroke")}},fs=()=>{N.pluginConfig.faviconsEnabled?fo():po()},ds=()=>{N.pluginConfig.inheritExtColor?ls():us()},fo=async()=>{N.pluginConfig.faviconsEnabled&&setTimeout(()=>{N.favIconsCache=new Map,lo()},500)},po=()=>{N.favIconsCache.clear(),cs()};var mr={},ps={get exports(){return mr},set exports(o){mr=o}};(function(o){(function(a){var u=function(){},b=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.msRequestAnimationFrame||function(g){return setTimeout(g,16)};function _(){var g=this;g.reads=[],g.writes=[],g.raf=b.bind(a)}_.prototype={constructor:_,runTasks:function(g){for(var C;C=g.shift();)C()},measure:function(g,C){var Z=C?g.bind(C):g;return this.reads.push(Z),F(this),Z},mutate:function(g,C){var Z=C?g.bind(C):g;return this.writes.push(Z),F(this),Z},clear:function(g){return h(this.reads,g)||h(this.writes,g)},extend:function(g){if(typeof g!="object")throw new Error("expected object");var C=Object.create(this);return L(C,g),C.fastdom=this,C.initialize&&C.initialize(),C},catch:null};function F(g){g.scheduled||(g.scheduled=!0,g.raf(O.bind(null,g)))}function O(g){var C=g.writes,Z=g.reads,x;try{u("flushing reads",Z.length),g.runTasks(Z),u("flushing writes",C.length),g.runTasks(C)}catch(y){x=y}if(g.scheduled=!1,(Z.length||C.length)&&F(g),x)if(u("task errored",x.message),g.catch)g.catch(x);else throw x}function h(g,C){var Z=g.indexOf(C);return!!~Z&&!!g.splice(Z,1)}function L(g,C){for(var Z in C)C.hasOwnProperty(Z)&&(g[Z]=C[Z])}var P=a.fastdom=a.fastdom||new _;o.exports=P})(typeof window<"u"?window:fn)})(ps);const hs=mr,gs=`.is-awLi-enabled .page-icon:not(.whiteboard-page .page-icon){display:none!important}.awLi-icon{position:relative;top:2px;display:inline-block;margin-right:5px;width:16px;height:16px;text-align:center;font-size:1.2em;line-height:1.26em;font-weight:400}.awLi-icon[data-is-emoji=true]{top:0;font-size:.9em!important}.title .awLi-icon{top:0;width:1em;height:1em;line-height:inherit}.title .awLi-icon[data-is-emoji=true]{line-height:1.7em;margin-right:.6em}.awLi-hideTitle .awLi-icon{margin-right:0}.awLi-color:is(.page-ref,.references li a,.page-title,.journal-title .title){color:var(--awLi-color)!important}body:not(.awLi-tagHasBg) .tag.awLi-color{color:var(--awLi-color)!important}.awLi-tagHasBg .tag.awLi-color{color:var(--ls-primary-background-color);background-color:var(--awLi-color)!important}[data-theme=light] .awLi-stroke{-webkit-text-stroke:.3px #00000088}[data-theme=dark] .awLi-stroke{-webkit-text-stroke:.3px #ffffff88}.ls-page-title:before,.journal-title .title:before{display:none!important}
`,ms=`.logseq-tab-title{color:var(--awLi-color)!important}.awLi-icon{position:relative;top:1px;display:inline-block;margin-right:4px;width:16px;height:16px;text-align:center;font-size:1.1em;line-height:1.26em;font-weight:400}.awLi-icon[data-is-emoji=true]{top:0;font-size:.9em!important}.light .awLi-stroke{-webkit-text-stroke:.3px #00000088}.dark .awLi-stroke{-webkit-text-stroke:.3px #ffffff88}.logseq-tab .text-xs{display:none}
`;let Xe;const ys=()=>{go(),N.pluginConfig.pageIconsEnabled&&ho()},ho=async()=>{Xe=ye.getElementById("logseq-tabs_iframe"),N.pluginConfig.pageIconsEnabled&&(Qe.classList.add("awLi-icons"),logseq.provideStyle({key:"awLi-icon-css",style:gs}),N.defaultPageProps=qn(N.pluginConfig.defaultPageProps),N.defaultJournalProps=qn(N.pluginConfig.defaultJournalProps),Ls(),hr(),logseq.App.onThemeChanged(()=>{setTimeout(()=>{hr()},2e3)}),logseq.App.onThemeModeChanged(()=>{setTimeout(()=>{hr()},2e3)}),logseq.App.onRouteChanged(()=>{bs()}))},hr=()=>{ks(),Cs(),mo(),vs()},go=()=>{Qe.classList.remove("awLi-icons"),ye.head.querySelector(`style[data-injected-style="awLi-icon-css-${N.pluginID}"]`)?.remove(),As(),Ss(),js()},mo=async o=>{o||(o=ye);const a=[...o.querySelectorAll(N.titleSelector)];a&&Un(a,!0);const u=[...o.querySelectorAll(N.pageLinksSelector)];u.length&&Un(u,!0);const b=[...o.querySelectorAll(N.sidebarLinkSelector)];b&&Un(b)},vs=async()=>{if(Xe&&Xe.contentDocument){const o=[...Xe.contentDocument.querySelectorAll(N.tabLinkSelector)];o&&Un(o)}},bs=async()=>{if(Xe&&Xe.contentDocument){const o=Xe.contentDocument.querySelector('.logseq-tab[data-active="true"] .logseq-tab-title');o&&yr(o)}},Un=(o,a)=>{if(o.length)for(let u=0;u<o.length;u++){const b=o[u];hs.mutate(()=>{yr(b,a)})}},yr=async(o,a)=>{const u=o.textContent;if(u&&!u.startsWith(" ")){const b=o.getAttribute("data-ref")||o.childNodes[1]?.textContent?.trim()||o.textContent?.trim()||"";if(b){const _=await io(b);_&&(ws(o,_,a),xs(o,_))}}},ws=async(o,a,u)=>{const b=a.icon;if(!(b===N.defaultPageProps.icon&&u)&&b&&b!=="none"){const _=o.querySelector(".awLi-icon");_&&_.remove(),_s(o,a),o.insertAdjacentHTML("afterbegin",`<span class="awLi-icon" data-is-emoji="${is(b)}">${b}</span>`)}},_s=(o,a)=>{if(a.hidetitle&&(o.classList.contains("page-ref")||o.classList.contains("tag"))){o.classList.add("awLi-hideTitle");const u=o.textContent,b=a.hidetitletext||"",_=new RegExp(b,"i");o.textContent=u.replace(_,"")}else o.classList.remove("awLi-hideTitle")},xs=async(o,a)=>{o.classList.remove("awLi-stroke");const u=a.color;if(u&&u!=="none"){const b=getComputedStyle(o).getPropertyValue("awLi-color");!b&&b!==u&&(o.style.setProperty("--awLi-color",u),o.style.setProperty("--ls-tag-text-color",u),o.classList.add("awLi-color"));const _=o.classList.contains("tag")?N.themeColor:N.themeBg;N.pluginConfig.fixLowContrast&&ao(u,_)&&o.classList.add("awLi-stroke")}else o.classList.remove("awLi-color"),o.style.removeProperty("--awLi-color"),o.style.removeProperty("--ls-tag-text-color"),o.classList.remove("awLi-stroke")},Cs=()=>{const o=ye.createElement("a");o.classList.add("tag"),Qe.insertAdjacentElement("beforeend",o);const a=getComputedStyle(o).backgroundColor.trim();o.remove(),a!=="rgba(0, 0, 0, 0)"?(Qe.classList.add("awLi-tagHasBg"),N.tagHasBg=!0):(Qe.classList.remove("awLi-tagHasBg"),N.tagHasBg=!1)},ks=()=>{N.themeColor=getComputedStyle(Qr).getPropertyValue("--ls-primary-text-color").trim(),N.themeBg=getComputedStyle(Qr).getPropertyValue("--ls-primary-background-color").trim()},As=()=>{const o=[...ye.querySelectorAll(`${N.pageLinksSelector}, ${N.titleSelector}, ${N.sidebarLinkSelector}`)];yo(o)},Ss=()=>{if(!Xe||!Xe.contentDocument)return;const o=[...Xe.contentDocument.querySelectorAll(N.tabLinkSelector)];yo(o)},yo=o=>{if(o.length)for(let a=0;a<o.length;a++){const u=o[a];u.style.removeProperty("--awLi-color"),u.classList.remove("awLi-stroke"),u.querySelector(".awLi-icon")?.remove()}},Ls=()=>{ss("logseq-tabs_iframe","awLi-tabs-styles",ms)},js=()=>{co("logseq-tabs_iframe","awLi-tabs-styles")};let vr,vo;const Es=()=>{vo={childList:!0,subtree:!0},vr=new MutationObserver(Os)},Os=function(o){for(let a=0;a<o.length;a++){const b=o[a].addedNodes[0];if(b&&b.childNodes.length&&(N.pluginConfig.pageIconsEnabled&&mo(b),N.pluginConfig.faviconsEnabled)){const _=[...b.querySelectorAll(N.extLinksSelector)];_.length&&lo(_)}}},Is=()=>{const o=ye.getElementById("app-container");o&&vr.observe(o,vo)},Ts=()=>{vr.disconnect()};let br,bo;const Ps=()=>{bo={childList:!0,subtree:!0},br=new MutationObserver(Fs)},Fs=function(o){for(let a=0;a<o.length;a++){const b=o[a].addedNodes[0];if(b&&b.childNodes.length){const _=b.querySelector(".logseq-tab-title");_&&yr(_)}}},Ms=()=>{const o=ye.getElementById("logseq-tabs_iframe");if(o){const a=o.contentDocument?.querySelector(".logseq-tab-wrapper");a&&br.observe(a,bo)}},Ns=()=>{br.disconnect()},Rs=`body[data-awli-icon-font=nerd] :is(.page-icon,.awLi-icon,.is-icon-active .page>.relative>.flex-row>.flex-1::before){font-family:var(--ls-font-family),"nerd","tabler-icons";width:1.2em}body[data-awli-icon-font=tabler-icons] :is(.page-icon,.awLi-icon,.is-icon-active .page>.relative>.flex-row>.flex-1::before){font-family:var(--ls-font-family),"tabler-icons"}body[data-awli-icon-font=nerd] :is(.desc-item[data-key="defaultPageProps"] .form-input,.desc-item[data-key="defaultJournalProps"] .form-input,){font-family:var(--ls-font-family),"nerd","tabler-icons",sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol!important}body[data-awli-icon-font=tabler-icons] :is(.desc-item[data-key="defaultPageProps"] .form-input,.desc-item[data-key="defaultJournalProps"] .form-input,){font-family:var(--ls-font-family),"tabler-icons",sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol!important}.editor-inner textarea{font-family:var(--ls-font-family),"tabler-icons","nerd",sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol!important}
`;let pt;const Ds=()=>{logseq.provideStyle({key:"awLi-icon-font-css",style:Rs}),_o()},wo=()=>{ye.head.querySelector(`style[data-injected-style="awLi-icon-font-css-${N.pluginID}"]`)?.remove()},_o=()=>{switch(N.pluginConfig.iconFont){case"nerd":zs(),Qe.dataset.awliIconFont="nerd";break;case"tabler-icons":Us(),Qe.dataset.awliIconFont="tabler-icons";break;case"None":delete Qe.dataset.awliIconFont,wo();break}},zs=async()=>{setTimeout(()=>{ye.head.insertAdjacentHTML("beforeend",`<style id="awLi-nerd-font-css">
                @font-face {
                    font-family: "nerd";
                    font-style: normal;
                    font-weight: 400;
                    src: url('lsp://logseq.io/${N.pluginID}/dist/fonts/nerd.ttf?v=2') format('truetype');
                }
            </style>`),pt=ye.getElementById("logseq-tabs_iframe"),pt&&(pt.contentDocument?.getElementById("awLi-nerd-font-css")?.remove(),pt.contentDocument?.head.insertAdjacentHTML("beforeend",`<style id="awLi-nerd-font-css">
                    @font-face {
                        font-family: "nerd";
                        font-style: normal;
                        font-weight: 400;
                        src: url('lsp://logseq.io/${N.pluginID}/dist/fonts/nerd.ttf?v=2') format('truetype');
                    }
                    .awLi-icon {
                        font-family: "nerd";
                    }
                </style>`))},1e3)},Us=()=>{pt=ye.getElementById("logseq-tabs_iframe"),pt&&(pt.contentDocument?.getElementById("awLi-tabler-font-css")?.remove(),pt.contentDocument?.head.insertAdjacentHTML("beforeend",`<style id="awLi-tabler-font-css">
                @font-face {
                    font-family: "tabler-icons";
                    font-style: normal;
                    font-weight: 400;
                    src: url('lsp://logseq.io/${N.pluginID}/dist/fonts/tabler-icons.woff2') format('woff2');
                }
                .awLi-icon {
                    font-family: "tabler-icons";
                }
            </style>`))},qs=()=>{Hs(),Bs(),setTimeout(()=>{logseq.beforeunload(async()=>{$s()})},2e3),N.pluginConfig.featureUpdaterEnabled&&setTimeout(()=>{os()},8e3)},Hs=async()=>{setTimeout(()=>{ye.head&&ye.head.insertAdjacentHTML("beforeend",`<link rel="stylesheet" id="css-awLi" href="lsp://logseq.io/${N.pluginID}/dist/assets/awesomeLinks.css">`)},500)},Bs=async()=>{Qe.classList.add(N.isPluginEnabled),Ds(),setTimeout(()=>{ho(),fo()},3e3),setTimeout(()=>{(N.pluginConfig.faviconsEnabled||N.pluginConfig.pageIconsEnabled)&&(Es(),Is()),N.pluginConfig.pageIconsEnabled&&(Ps(),Ms())},4e3)},$s=()=>{Qe.classList.remove(N.isPluginEnabled),go(),po(),wo(),Ts(),Ns()};const Gs=[{key:"promoAwesomeStyler",title:"",description:' Also try "Awesome Styler" theme with lots of UI changes and more features!  https://github.com/yoyurec/logseq-awesome-styler',type:"boolean",default:!1},{key:"externalHeading",title:"External links",description:"",type:"heading",default:null},{key:"faviconsEnabled",title:"",description:"Enable feature: favicons for external links?",type:"boolean",default:!0},{key:"inheritExtColor",title:"",description:"Inherit link color from first inline tag/ref",type:"boolean",default:!0},{key:"internalHeading",title:"Internal links",description:"",type:"heading",default:null},{key:"pageIconsEnabled",title:"",description:"Enable feature: icon/color for internal pages?",type:"boolean",default:!0},{key:"inheritingHeading",title:"Inheriting",description:"",type:"heading",default:null},{key:"inheritFromProp",title:"",description:"Inherit page icon/color via custom property (delete to disable)",type:"string",default:"page-type"},{key:"inheritFromHierarchy",title:"",description:"Inherit page icon/color via hierarchy?",type:"boolean",default:!0},{key:"dafaultPropsHeading",title:"Default props",description:"",type:"heading",default:null},{key:"defaultPageProps",title:"",description:"Pages default props: icon (emoji or Nerd icon) and color. (Delete to disable)",type:"string",inputAs:"textarea",default:`icon::
color::`},{key:"defaultJournalProps",title:"",description:"Journal pages default props: icon (emoji or Nerd icon) and color. (Delete to disable)",type:"string",inputAs:"textarea",default:`icon::
color::`},{key:"iconsFontHeading",title:"Additional icons",description:"extend emoji icons with external set",type:"heading",default:null},{key:"iconFont",title:"Choose icons set font",description:"To insert icon:: value, you need to search for icon and copy its glyph. Nerd font - https://www.nerdfonts.com/cheat-sheet, Tabler - use icon-picker from AwesomeProps plugin",type:"enum",enumPicker:"radio",enumChoices:["none","nerd","tabler-icons"],default:"tabler-icons"},{key:"otherHeading",title:"Other",description:"",type:"heading",default:null},{key:"fixLowContrast",title:"",description:" Experimental: Enable text black/white stroke for low contrast links colors",type:"boolean",default:!1},{key:"featureUpdaterEnabled",title:"",description:"Enable new version notifier on app load?",type:"boolean",default:!0}],Zs=()=>{logseq.useSettingsSchema(Gs),N.pluginConfig=logseq.settings,logseq.onSettingsChanged((o,a)=>{Vs(o,a)})},Vs=(o,a)=>{N.defaultPageProps=qn(N.pluginConfig.defaultPageProps),N.defaultJournalProps=qn(N.pluginConfig.defaultJournalProps),N.pluginConfig={...o};const u=rs({...a},N.pluginConfig);u.includes("faviconsEnabled")&&fs(),u.includes("inheritExtColor")&&ds(),(u.includes("pageIconsEnabled")||u.includes("inheritFromHierarchy")||u.includes("defaultJournalProps")||u.includes("fixLowContrast"))&&ys(),u.includes("iconFont")&&_o()},Ws=async()=>{console.log("AwesomeIcons: plugin loaded"),Zs(),qs()};logseq.ready(Ws).catch(null);
//# sourceMappingURL=awesomeLinks.js.map
